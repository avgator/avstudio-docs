import{r as p,j as t,O as w,g as B,f as D,bW as I,ar as O,N as k,y as A,S as c,bQ as G,B as h,cA as S,J as v}from"./main-C9kTvUvK.js";import{E as R}from"./EditableCell-DIG1vBc-.js";import{R as y}from"./MobileOutlined-CClvNI14.js";import"./index-DimBv2aS.js";const T=({onChange:o,checked:r})=>{const[n,i]=p.useState(!1);return t.jsx(w,{loading:n,onChange:d=>{i(!0),o(d).then(()=>i(!1))},checked:r})},{Title:V}=G,E=[{title:"Name",dataIndex:"name",sorter:(o,r)=>{try{const n=o.name.props.initialValue.toLowerCase(),i=r.name.props.initialValue.toLowerCase();if(n<i)return-1;if(n>i)return 1}catch(n){console.log(n)}return 0},defaultSortOrder:"ascend"},{title:"Position",dataIndex:"position"},{title:"Visible on Pages",dataIndex:"visibleOnPages"},{title:"Hidden on Pages",dataIndex:"hiddenOnPages"},{title:"Visible by default",dataIndex:"visibleByDefault"},{title:"Actions",width:"100px",dataIndex:"globalContainerActions"}],F=()=>{const{projectId:o}=B(),r=D(b=>b.workingProject),n=r?.attributes.globalContainers,{setNewGlobalContainerVisible:i}=I(),[d,f]=p.useState();return p.useEffect(()=>{function b(a,e){if(!n)return null;const l=structuredClone(n);l.splice(a,1),o&&v({projectId:o,inputData:{globalContainers:l}})}async function u(a,e){return new Promise((l,s)=>{if(!n)return null;const g=structuredClone(n);g[a]={...g[a],...e},o?v({projectId:o,inputData:{globalContainers:g}}).then(()=>{l("Ok")}).catch(j=>s(j)):s("No projectId")})}const m=r?.attributes.pages.data?.filter(a=>!a.attributes.isSubpage)||[];function C(){const a=[];if(m?.length)for(const e of m)a.push({value:e.id,label:e.attributes.name||"noName"});return a}function x(a){if(!n)return null;const e=n[a];return t.jsx(c,{disabled:!!e.visibleByDefault,value:e.visibleOnPages,onChange:l=>{u(a,{visibleOnPages:[...l]})},placeholder:e.visibleByDefault?"Visible by default":"Add pages...",style:{width:200},mode:"multiple",allowClear:!0,options:C()})}function P(a){if(!n)return null;const e=n[a];return t.jsx(c,{disabled:!e.visibleByDefault,value:e.hiddenOnPages,onChange:l=>{u(a,{hiddenOnPages:[...l]})},placeholder:e.visibleByDefault?"Add pages...":"Hidden by default",style:{width:200},mode:"multiple",allowClear:!0,options:C()})}if(n?.length){const a=[];n.forEach((e,l)=>{a.push({key:`globalContainer_${l}`,order:l+1,name:t.jsx(R,{onChange:s=>s&&u(l,{name:s}),initialValue:e.name,value:e.name}),position:t.jsxs(t.Fragment,{children:[t.jsx(c,{value:e.portraitPosition,onChange:s=>u(l,{portraitPosition:s}),style:{width:100,marginRight:10},suffixIcon:t.jsx(y,{}),options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"},{value:"null",label:"Hidden"}]}),t.jsx(c,{value:e.landscapePosition,onChange:s=>u(l,{landscapePosition:s}),style:{width:100},suffixIcon:t.jsx(y,{rotate:90}),options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"},{value:"null",label:"Hidden"}]})]}),visibleByDefault:t.jsx(T,{onChange:()=>u(l,{visibleByDefault:!e.visibleByDefault}),checked:e.visibleByDefault}),visibleOnPages:x(l),hiddenOnPages:P(l),globalContainerActions:t.jsx(O.Button,{menu:{items:[{key:"remove",label:"Remove",onClick:()=>k({title:"Delete Container?",icon:t.jsx(A,{}),content:"Are you sure to delete Global Container with all elements inside? It cannot be undone.",okText:"Delete container",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>b(l,e.name),onCancel:()=>console.log("cancel global container delete")})}]}})})}),f(a)}else f([])},[n,o,r]),t.jsxs(t.Fragment,{children:[t.jsx(V,{id:"Global Containers",style:{margin:"15px 0"},level:5,children:t.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t.jsxs("span",{children:["Global Containers ",` (${n?.length||0})`]}),t.jsx(h,{onClick:()=>i(!0),children:"Create Global Container"})]})}),t.jsx(S,{columns:E,dataSource:d,pagination:!1}),t.jsx(h,{style:{marginTop:15},type:"primary",onClick:()=>i(!0),children:"Create Global Container"},"submit")]})};export{F as default};
