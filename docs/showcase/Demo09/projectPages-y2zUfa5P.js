import{r as g,I as A,_ as S,u as $,f as E,g as z,bW as O,j as e,aK as F,y as I,D as C,B as u,cJ as h,ar as U,J,ax as W,a3 as Y,Z as k,z as H,bQ as G,a2 as K,cA as q,a1 as Q}from"./main-C9kTvUvK.js";import{P as Z,D as X}from"./driverGuideButton-CB8g2Q29.js";import{E as w}from"./EditableCell-DIG1vBc-.js";import{i as ee,a as ae,h as T,P as te,u as _}from"./pageAPI-4o2eRx6B.js";import{R as L}from"./renderActionTag-C_HVBKU8.js";import{d as se}from"./deletePage-Br-nFKP3.js";import{OneProjectGuideContext as ie}from"./oneProject-DFpMieA9.js";import{T as ne}from"./tableFieldSearchInput-N9HEsIiN.js";import{P as V}from"./index-CCUbw95p.js";import{R as re}from"./DiffOutlined-BWVCEeCe.js";import"./index-DimBv2aS.js";var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32z"}}]},name:"flag",theme:"filled"},oe=function(c,x){return g.createElement(A,S(S({},c),{},{ref:x,icon:le}))},D=g.forwardRef(oe);const{Title:de}=G,ye=()=>{const m=$(),[c,x]=g.useState(),i=E(r=>r.workingProject),R=!ee({project:i}),{projectId:l}=z(),{setNewPageModalVisible:j,setEditProjectModalId:b}=O(),[f,P]=g.useState(null),y=g.useMemo(()=>{const r=[],d=i?.attributes.pages.data?.filter(n=>!n.attributes?.isSubpage);for(const n of d??[]){const s=n.attributes.pageFlips?.analogPageFlipValue;s!=null&&r.push(s)}return r},[i?.attributes.pages.data]),B=[{title:e.jsxs(Z,{children:[e.jsx(ne,{value:c,setValue:x}),e.jsx("div",{style:{paddingRight:10},children:e.jsx(V,{content:e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{children:"Project page flip serial signal name"}),e.jsx(L,{style:{margin:"0 3px 0 0"},crestronLikeTypesNaming:!0,type:"s",sub:"signal name"})," ",e.jsx("strong",{children:i?.attributes.globalJoins?.serialPageFlip_signal_s_fb||"not set"}),e.jsx(C,{style:{margin:"15px 0 10px 0"}}),e.jsx("div",{children:e.jsx(u,{block:!0,style:{marginTop:10},type:"dashed",size:"small",onClick:()=>i&&b(i.id),children:"Open project settings"})})]})}),title:"Page flip serial",children:i?.attributes.globalJoins?.serialPageFlip_signal_s_fb?e.jsx(F,{style:{color:"#0eae23",marginLeft:"0.6em"}}):e.jsx(I,{style:{color:"#ff6d24",marginLeft:"0.6em"}})})})]}),dataIndex:"name",sorter:(r,d)=>{const n=r.name.props.initialValue.toLowerCase(),s=d.name.props.initialValue.toLowerCase();return n<s?-1:n>s?1:0},defaultSortOrder:"ascend"},{title:e.jsx(e.Fragment,{children:"Design paradigm"}),dataIndex:"layoutMode"},{title:e.jsxs(e.Fragment,{children:["Analog flip ID",e.jsx(V,{content:e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("div",{children:"Project page flip analog signal name"}),e.jsx(L,{style:{margin:"0 3px 0 0"},crestronLikeTypesNaming:!0,type:"a",sub:"signal name"})," ",e.jsx("strong",{children:i?.attributes.globalJoins?.analogPageFlip_signal_a_fb||"not set"}),e.jsx(C,{style:{margin:"15px 0 10px 0"}}),e.jsx("div",{children:e.jsx(u,{block:!0,style:{marginTop:10},type:"dashed",size:"small",onClick:()=>i&&b(i.id),children:"Open project settings"})})]})}),title:"Page flip analog",children:i?.attributes.globalJoins?.analogPageFlip_signal_a_fb?e.jsx(F,{style:{color:"#0eae23",marginLeft:"0.6em"}}):e.jsx(I,{style:{color:"#ff6d24",marginLeft:"0.6em"}})})]}),dataIndex:"analogFlip"},{title:"Updated",dataIndex:"updated",sorter:(r,d)=>{const n=h(r.updated),s=h(d.updated);return n.isBefore(s)?-1:n.isAfter(s)?1:0},render:r=>e.jsx(e.Fragment,{children:h(r).format("MMM D, YYYY, h:mm A")})},{title:"Subpages Used",dataIndex:"subUsed"},{title:"Actions",dataIndex:"actions",width:100}];g.useEffect(()=>{function r(s){let a=null;return String(s)===String(i?.attributes.startPage)&&(a=e.jsx(Q,{placement:"topLeft",title:"This is Start Page",children:e.jsx(D,{})})),a}function d(s){const a=[];for(const t of s.attributes.containers??[])for(const o of t.elements)if(o.type==="subpage"||o.type==="subpageList"){const p=i?.attributes.pages.data.find(N=>N.id===o.subpageId)?.attributes.name;a.push({id:o.subpageId,name:p||"No name"})}return a.length?a.map((t,o)=>e.jsx(u,{onClick:p=>T({pageId:t.id,navigate:m,evt:p,projectId:l}),type:"dashed",size:"small",children:t.name},`${t.id}_${o}`)):null}let n=i?.attributes.pages.data?.filter(s=>!s.attributes.isSubpage);if(n?.length){c&&(n=n.filter(a=>{const t=a.attributes.name;if(!t)return!1;const o=t.trim().toLowerCase(),p=c.trim().toLowerCase();return o.includes(p)}));const s=[];for(const a of n)s.push({pageID:a.id,key:`page_${a.id}`,name:e.jsx(w,{onChange:t=>t&&l&&_({pageId:a.id,inputData:{name:t}}),initialValue:a.attributes.name,value:e.jsxs(e.Fragment,{children:[r(a.id)," ",a.attributes.name]}),validators:[t=>k({input:t,searchArray:n||[],searchKey:["attributes","name"]}).catch(o=>(H.error(o.message),Promise.reject()))]}),analogFlip:e.jsx(e.Fragment,{children:e.jsx(w,{onChange:t=>l&&_({pageId:a.id,inputData:{pageFlips:{...a.attributes.pageFlips,analogPageFlipValue:t}}}),initialValue:a.attributes.pageFlips?.analogPageFlipValue??null,value:a.attributes.pageFlips?.analogPageFlipValue??null,validators:[t=>k({input:t,searchArray:y})]})}),layoutMode:e.jsx(Y,{icon:e.jsx(te,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:a.attributes?.isStatic}),children:a.attributes?.isStatic?"adaptive":"responsive"}),updated:a.attributes.updatedAt,subUsed:e.jsx("div",{style:{display:"flex",gap:5,flexWrap:"wrap"},children:d(a)}),actions:e.jsxs(U.Button,{onClick:t=>T({pageId:a.id,navigate:m,evt:t,projectId:l}),menu:{items:[a.attributes.isSubpage?null:{key:"startPage",icon:e.jsx(D,{}),label:"Mark as Start Page",onClick:()=>l&&J({projectId:l,inputData:{startPage:`${a.id}`}})},{key:"clonePage",icon:e.jsx(re,{}),label:"Clone Page",onClick:()=>l&&ae({pageCloneData:a})},{key:"remove",danger:!0,icon:e.jsx(W,{}),label:"Delete Page",onClick:()=>l&&se({pageId:a.id,projectId:l,name:a.attributes.name})}]},children:[e.jsx("svg",{style:{marginRight:3,marginBottom:-2},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M6 2c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-1.9l10-10V8l-6-6zm7 1.5L18.5 9H13zm7.1 9.5c-.1 0-.3.1-.4.2l-1 1l2.1 2.1l1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-2 1.8L12 20.9V23h2.1l6.1-6.1z"})}),"Open in Editor"]})});P(s)}else P([])},[m,l,i,c,y]);const M=g.useContext(ie),v="PagesSection";return e.jsxs("div",{id:v,children:[e.jsx(de,{id:"Pages",style:{margin:"15px 0"},level:5,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:["Pages",e.jsx(X,{guide:M,guideStartTargetElement:`#${v}`})]}),!!f?.length&&R&&e.jsxs("div",{style:{fontWeight:"normal",textTransform:"uppercase",fontSize:10,borderRadius:5,background:"#fff",padding:"5px 7px",border:"0.5px var(--ant-primary-5) dashed"},children:[e.jsx(K,{style:{color:"var(--ant-primary-5)"}})," ","No start page found, please set one"]}),e.jsx(u,{onClick:()=>j("page"),children:"Create New Page"})]})}),f?e.jsxs(e.Fragment,{children:[e.jsx(q,{showSorterTooltip:!1,columns:B,dataSource:f,pagination:!1}),e.jsx(u,{style:{marginTop:15},type:"primary",onClick:()=>j("page"),children:"Create New Page"})]}):null]})};export{ye as default};
