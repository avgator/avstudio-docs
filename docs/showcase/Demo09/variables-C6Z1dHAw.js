const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./actionsOptions-D2o-B9Cc.js","./main-C9kTvUvK.js","./main-CUVazYpt.css","./renderActionTag-C_HVBKU8.js","./formItemPropsWrapper-ChMcIfaN.js","./index-CCUbw95p.js","./EditableCell-DIG1vBc-.js","./index-DimBv2aS.js"])))=>i.map(i=>d[i]);
import{E as S,r as s,j as e,S as I,g as P,bW as _,f as w,am as k,ai as A,ar as R,N as E,y as L,ax as O,i as D,P as B,z as N,bQ as $,B as C,cA as M,aA as h,m as z,bO as U}from"./main-C9kTvUvK.js";import{E as V}from"./EditableCell-DIG1vBc-.js";import{R as v}from"./renderActionTag-C_HVBKU8.js";import{T as W}from"./tableFieldSearchInput-N9HEsIiN.js";import{P as Q}from"./index-CCUbw95p.js";import"./index-DimBv2aS.js";const q=S.memo(({functionUid:o,onChange:x,formatterFunctions:r})=>{const p=s.useCallback(u=>u?r.find(l=>l.uid===u):void 0,[r]),b=s.useMemo(()=>r?.length?[{label:"Predefined formatters",options:r.map(m=>{const{uid:l,name:g}=m;return{label:g,value:l}})}]:[],[r]),c=s.useMemo(()=>p(o),[o,p]),{description:f}=c??{},d=s.useMemo(()=>o&&!c?"deleted":o,[c,o]),j=c?"":"notformatted";return e.jsxs(e.Fragment,{children:[e.jsx(I,{className:j,allowClear:!0,style:{width:"100%"},placeholder:"Attach formatter function",showSearch:!0,filterOption:(u,m)=>m.label.toLowerCase().includes(u.toLowerCase()),value:d,options:b,onChange:x}),e.jsx("div",{style:{fontSize:"10px",color:"gray",paddingTop:"3px"},children:f})]})}),G=s.lazy(()=>z(()=>import("./actionsOptions-D2o-B9Cc.js").then(o=>o.v),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url)),{Title:H}=$,J={project:{title:"Project Variables",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(h,{})," Add Project Variable"]})},page:{title:"Page Parameters",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(h,{})," Add Page Parameter"]})},subpage:{title:"Subpage Parameters",buttonText:e.jsxs(e.Fragment,{children:[e.jsx(h,{})," Add Subpage Parameter"]})}},ae=S.memo(({tableFor:o})=>{const{projectId:x,pageId:r}=P(),{setNewVariableModalVisible:p}=_(),{title:b,buttonText:c}=J[o],f=w(a=>{const n=a.workingProject?.attributes;return n?o==="project"?n.variables??[]:n.pages.data?.find(t=>t.id===r)?.attributes.parameters??[]:[]}),[d,j]=s.useState(),u=s.useCallback((a,n)=>{const t=a.name.toLowerCase(),i=n.name.toLowerCase();return t<i?-1:t>i?1:0},[]),m=[{title:e.jsx(W,{setValue:j,value:d}),dataIndex:"name",sorter:u,defaultSortOrder:"ascend"},{title:"Type",dataIndex:"type"},{title:"Default Value",dataIndex:"defaultValue"},{title:"Signal FB Setter",dataIndex:"joinValueSetter_signal_fb"},{title:"Formatter function",dataIndex:"formatValueFunctionUid",className:"formatterCell"},{title:e.jsxs(e.Fragment,{children:["Side Effect Actions",e.jsx(Q,{placement:"top",title:"Reactivity",content:e.jsx("div",{style:{width:"250px"},children:"Run actions when value has been changed."}),trigger:"hover",children:e.jsx(U,{style:{marginLeft:7}})})]}),dataIndex:"sideEffects",className:"sideEffectsCell"},{title:"Controls",dataIndex:"controls",width:100}],l=s.useCallback((a,n)=>k({projectId:x,pageId:r,variableData:a,actionType:n}),[r,x]),g=s.useCallback(({formatValueFunctionUid:a,variableData:n})=>{l({...n,formatValueFunctionUid:a},"update")},[l]),y=A(a=>a.formatterFunctions),F=s.useMemo(()=>{const a=[],n=d?f.filter(t=>t.name.toLowerCase().includes(d.toLowerCase().trim())):f;for(const t of n)a.push({key:`variable_${t.name}`,name:t.name,type:e.jsx(e.Fragment,{children:e.jsx(v,{crestronLikeTypesNaming:!1,style:{margin:1},type:t.type,sub:t.type==="boolean"&&t?.waitForLoadingUi?" ui loader":""})}),defaultValue:e.jsx(V,{onChange:i=>l({...t,defaultValue:i},"update"),initialValue:t.defaultValue,value:t.defaultValue}),joinValueSetter_signal_fb:e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(v,{style:{margin:1},type:t.type,sub:"FB"}),e.jsx(V,{style:{marginLeft:".5em"},onChange:i=>l({...t,joinValueSetter_signal_fb:i},"update"),initialValue:t.joinValueSetter_signal_fb??"",value:t.joinValueSetter_signal_fb??"",validators:[i=>B(i).catch(T=>(N.error(T.message),Promise.reject()))]})]}),formatValueFunctionUid:e.jsx(q,{onChange:i=>g({variableData:t,formatValueFunctionUid:i}),functionUid:t.formatValueFunctionUid,formatterFunctions:y[t.type]}),sideEffects:e.jsx(s.Suspense,{fallback:e.jsx(D,{}),children:e.jsx(G,{actionsArr:t?.actions??[],elementType:"variable",variableActionFor:t})}),controls:e.jsx(R.Button,{menu:{items:[{key:"removeVariable",danger:!0,icon:e.jsx(O,{}),label:"Delete",onClick:()=>E({title:`Delete ${t.name}?`,icon:e.jsx(L,{}),content:"Are you sure? It cannot be undone.",okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>l(t,"delete"),onCancel:()=>console.log("cancel variable delete")})}]}})});return a},[y,g,l,f,d]);return e.jsxs(e.Fragment,{children:[e.jsx(H,{id:"Variables",style:{margin:"15px 0"},level:5,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("span",{children:b}),e.jsx(C,{onClick:()=>p(r?"parameter":"project"),children:c})]})}),e.jsxs(e.Fragment,{children:[e.jsx(M,{columns:m,dataSource:F||[],pagination:!1}),e.jsx(C,{style:{marginTop:15},type:"primary",onClick:()=>p(r?"parameter":"project"),children:c},"submit")]})]})});export{ae as default};
