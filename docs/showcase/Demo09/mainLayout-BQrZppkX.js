const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./undoRedo-GMSbyzn2.js","./main-C9kTvUvK.js","./main-CUVazYpt.css","./details-CQoO5yCc.js","./details-BO9_zmax.css","./Styles-B6kWeBqL.js","./index-DimBv2aS.js","./formItemPropsWrapper-ChMcIfaN.js","./renderActionTag-C_HVBKU8.js","./moment-G82_0lEo.js","./modificatorAPI-Clnut5Hb.js","./index-CCUbw95p.js","./pageAPI-4o2eRx6B.js","./SettingOutlined-CxBXSFIm.js","./newProjectModal-DWeQAiK7.js"])))=>i.map(i=>d[i]);
import{r as u,I as ue,_ as K,n as sa,o as ft,p as Vt,s as oa,q as ia,g as ee,j as e,F as p,M as oe,B as P,t as la,v as ca,w as ct,f as O,x as da,y as pe,z as ce,A as ua,E as me,G as z,S as _e,D as te,H as Ie,J as Ot,K as Bt,N as zt,O as de,P as He,Q as nt,U as Se,V as ma,W as ha,X as fa,Y as gt,i as je,Z as Ae,$ as qt,a0 as Gt,a1 as Ue,a2 as We,a3 as dt,a4 as Ht,a5 as Ut,a6 as Ve,a7 as ga,a8 as pt,a9 as pa,aa as va,ab as xa,ac as rt,ad as st,ae as ja,af as Wt,ag as vt,ah as xt,ai as ba,aj as fe,ak as ya,al as wa,am as Ca,an as Sa,ao as ka,ap as jt,aq as _a,l as Q,ar as $t,as as Ia,at as Ta,au as Ma,av as Kt,aw as ae,ax as Pa,u as ut,ay as Fa,az as Ne,aA as La,aB as Ea,aC as bt,aD as Da,aE as Jt,aF as Aa,aG as Na,aH as ot,L as Zt,m as mt,e as Ra,aI as Va,aJ as Oa,aK as Ba,h as za,aL as Qe,aM as qa,aN as Ga,aO as Ha,aP as Ua}from"./main-C9kTvUvK.js";import{h as Wa,u as $e,D as yt,S as $a}from"./details-CQoO5yCc.js";import{D as Ka,R as Ja,u as Za,A as Xa,a as Ya,b as Qa}from"./Styles-B6kWeBqL.js";import{I as it,S as Xt}from"./index-DimBv2aS.js";import{d as ye,C as Re,k as en,F as tn,u as ht}from"./formItemPropsWrapper-ChMcIfaN.js";import{R as Ce}from"./renderActionTag-C_HVBKU8.js";import{h as an}from"./moment-G82_0lEo.js";import{u as Yt,c as nn}from"./modificatorAPI-Clnut5Hb.js";import{P as ge}from"./index-CCUbw95p.js";import{P as lt,c as rn}from"./pageAPI-4o2eRx6B.js";import{R as et,a as sn}from"./SettingOutlined-CxBXSFIm.js";var on={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},ln=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:on}))},cn=u.forwardRef(ln),dn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917.7 148.8l-42.4-42.4c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-76.1 76.1a199.27 199.27 0 00-112.1-34.3c-51.2 0-102.4 19.5-141.5 58.6L432.3 308.7a8.03 8.03 0 000 11.3L704 591.7c1.6 1.6 3.6 2.3 5.7 2.3 2 0 4.1-.8 5.7-2.3l101.9-101.9c68.9-69 77-175.7 24.3-253.5l76.1-76.1c3.1-3.2 3.1-8.3 0-11.4zM769.1 441.7l-59.4 59.4-186.8-186.8 59.4-59.4c24.9-24.9 58.1-38.7 93.4-38.7 35.3 0 68.4 13.7 93.4 38.7 24.9 24.9 38.7 58.1 38.7 93.4 0 35.3-13.8 68.4-38.7 93.4zm-190.2 105a8.03 8.03 0 00-11.3 0L501 613.3 410.7 523l66.7-66.7c3.1-3.1 3.1-8.2 0-11.3L441 408.6a8.03 8.03 0 00-11.3 0L363 475.3l-43-43a7.85 7.85 0 00-5.7-2.3c-2 0-4.1.8-5.7 2.3L206.8 534.2c-68.9 69-77 175.7-24.3 253.5l-76.1 76.1a8.03 8.03 0 000 11.3l42.4 42.4c1.6 1.6 3.6 2.3 5.7 2.3s4.1-.8 5.7-2.3l76.1-76.1c33.7 22.9 72.9 34.3 112.1 34.3 51.2 0 102.4-19.5 141.5-58.6l101.9-101.9c3.1-3.1 3.1-8.2 0-11.3l-43-43 66.7-66.7c3.1-3.1 3.1-8.2 0-11.3l-36.6-36.2zM441.7 769.1a131.32 131.32 0 01-93.4 38.7c-35.3 0-68.4-13.7-93.4-38.7a131.32 131.32 0 01-38.7-93.4c0-35.3 13.7-68.4 38.7-93.4l59.4-59.4 186.8 186.8-59.4 59.4z"}}]},name:"api",theme:"outlined"},un=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:dn}))},mn=u.forwardRef(un),hn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},fn=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:hn}))},ke=u.forwardRef(fn),gn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M956 686.5l-.1-.1-.1-.1C911.7 593 843.4 545 752.5 545s-159.2 48.1-203.4 141.3v.1a42.92 42.92 0 000 36.4C593.3 816 661.6 864 752.5 864s159.2-48.1 203.4-141.3c5.4-11.5 5.4-24.8.1-36.2zM752.5 800c-62.1 0-107.4-30-141.1-95.5C645 639 690.4 609 752.5 609c62.1 0 107.4 30 141.1 95.5C860 770 814.6 800 752.5 800z"}},{tag:"path",attrs:{d:"M697 705a56 56 0 10112 0 56 56 0 10-112 0zM136 232h704v253h72V192c0-17.7-14.3-32-32-32H96c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h352v-72H136V232z"}},{tag:"path",attrs:{d:"M724.9 338.1l-36.8-36.8a8.03 8.03 0 00-11.3 0L493 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L251.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.2-3.1 3.2-8.2 0-11.3z"}}]},name:"fund-view",theme:"outlined"},pn=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:gn}))},vn=u.forwardRef(pn),xn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"},jn=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:xn}))},bn=u.forwardRef(jn),yn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 732h-70.3c-4.8 0-9.3 2.1-12.3 5.8-7 8.5-14.5 16.7-22.4 24.5a353.84 353.84 0 01-112.7 75.9A352.8 352.8 0 01512.4 866c-47.9 0-94.3-9.4-137.9-27.8a353.84 353.84 0 01-112.7-75.9 353.28 353.28 0 01-76-112.5C167.3 606.2 158 559.9 158 512s9.4-94.2 27.8-137.8c17.8-42.1 43.4-80 76-112.5s70.5-58.1 112.7-75.9c43.6-18.4 90-27.8 137.9-27.8 47.9 0 94.3 9.3 137.9 27.8 42.2 17.8 80.1 43.4 112.7 75.9 7.9 7.9 15.3 16.1 22.4 24.5 3 3.7 7.6 5.8 12.3 5.8H868c6.3 0 10.2-7 6.7-12.3C798 160.5 663.8 81.6 511.3 82 271.7 82.6 79.6 277.1 82 516.4 84.4 751.9 276.2 942 512.4 942c152.1 0 285.7-78.8 362.3-197.7 3.4-5.3-.4-12.3-6.7-12.3zm88.9-226.3L815 393.7c-5.3-4.2-13-.4-13 6.3v76H488c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"logout",theme:"outlined"},wn=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:yn}))},Cn=u.forwardRef(wn),Sn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M692.8 412.7l.2-.2-34.6-44.3a7.97 7.97 0 00-11.2-1.4l-50.4 39.3-70.5-90.1a7.97 7.97 0 00-11.2-1.4l-37.9 29.7a7.97 7.97 0 00-1.4 11.2l70.5 90.2-.2.1 34.6 44.3c2.7 3.5 7.7 4.1 11.2 1.4l50.4-39.3 64.1 82c2.7 3.5 7.7 4.1 11.2 1.4l37.9-29.6c3.5-2.7 4.1-7.7 1.4-11.2l-64.1-82.1zM608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5L114.3 856.1a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6C473 696.1 537.7 720 608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644s-118.2-23.7-161.2-66.8C403.7 534.2 380 476.9 380 416s23.7-118.2 66.8-161.2c43-43.1 100.3-66.8 161.2-66.8s118.2 23.7 161.2 66.8c43.1 43 66.8 100.3 66.8 161.2s-23.7 118.2-66.8 161.2z"}}]},name:"monitor",theme:"outlined"},kn=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:Sn}))},tt=u.forwardRef(kn),_n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M952 612c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H298a95.92 95.92 0 00-89-60c-53 0-96 43-96 96s43 96 96 96c40.3 0 74.8-24.8 89-60h150.3v152c0 55.2 44.8 100 100 100H952c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H548.3c-15.5 0-28-12.5-28-28V612H952zM456 344h264v98.2c0 8.1 9.5 12.8 15.8 7.7l172.5-136.2c5-3.9 5-11.4 0-15.3L735.8 162.1c-6.4-5.1-15.8-.5-15.8 7.7V268H456c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8z"}}]},name:"node-expand",theme:"outlined"},In=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:_n}))},Tn=u.forwardRef(In),Mn={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"},Pn=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:Mn}))},Fn=u.forwardRef(Pn),Ln={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},En=function(a,o){return u.createElement(ue,K(K({},a),{},{ref:o,icon:Ln}))},Dn=u.forwardRef(En);const wt={sourceContainerIndex:null,sourceContainerType:null,destinationContainerIndex:null,destinationContainerType:null,sourceElementIndex:null,destinationElementIndex:null,destinationElementCorner:null,destinationContainerFlow:null},ze=sa((t,a)=>({selectedElementRef:null,staticEementsGuidesClasses:[],activeStaticElementKey:null,dragData:wt,updateDragStore:o=>{const l=a().dragData,v={...l,...o};ft.isEqual(l,v)||t(()=>({dragData:v}))},resetDragStore:()=>{t(()=>({dragData:wt}))},setSelectedElementRef:o=>{t(()=>({selectedElementRef:o}))},setActiveStaticElementKey:o=>{t(()=>({activeStaticElementKey:o}))},setStaticEementsGuidesClasses:o=>{t(l=>{const v=l.staticEementsGuidesClasses;return v.includes(o)?l:{staticEementsGuidesClasses:[...v,o]}})}}),ft.isEqual),An=async()=>await Vt.get("/api/themes?sort=createdAt:asc&populate=deep,3",{headers:oa()}).then(t=>t?.data?.data?t.data.data:null).catch(t=>{console.log("Get news error occurred:",t)}),Qt=ia(t=>({themesList:[],fetchAndFillThemesList:async()=>{const a=await An();t({themesList:a||[]})}})),Nn=({cloneItemModal:t,setCloneItemModal:a,onFinish:o})=>{const[l]=p.useForm(),v=()=>{l.submit()};return e.jsx(oe,{destroyOnClose:!0,afterClose:()=>l.resetFields(),maskClosable:!1,title:`Cloning ${t.nodeType}`,open:!!t,onOk:v,onCancel:()=>a(null),footer:[e.jsx(P,{onClick:()=>a(null),children:"Cancel"},"back"),e.jsxs(P,{type:"primary",onClick:v,children:["Clone ",t.nodeType]},"submit")],children:e.jsx(p,{labelCol:{xs:{span:6}},wrapperCol:{xs:{span:16}},form:l,onFinish:c=>o(c),initialValues:{copiesCount:1},scrollToFirstError:!0,children:e.jsx(p.Item,{colon:!1,required:!1,name:"copiesCount",label:"How many copies",rules:[{required:!0,message:"This field is required."}],children:e.jsx(it,{min:1,max:10})})})})},Rn=()=>{const[t,a]=u.useState(null),{pageId:o}=ee(),l=({copiesCount:c})=>{const{containerIndex:g,elementIndex:f,nodeType:x,isGlobal:m}=t||{};g!==void 0&&(x==="container"?la({action:"clone",containerIndex:g,copiesCount:c,pageId:o}).then(()=>a(null)):f!==void 0&&ca({containerIndex:g,elementIndex:f,copiesCount:c,isGlobal:m,pageId:o,action:"clone"}).then(()=>a(null)))};return{CloneModal:t?e.jsx(Nn,{onFinish:l,setCloneItemModal:a,cloneItemModal:t}):null,setCloneItemModal:a}};function Vn(t){const a=/\/projects\/(\d+)/;return!!t.match(a)}const On=()=>{const t=ct(x=>x.jwt),a=O(x=>x.currentProjectHash),o=O(x=>x.savedProjectHash),l=O.getState().resetWorkingProject,{projectId:v}=ee(),c=!!t&&!!v&&a!==o,g=da(({nextLocation:x})=>{const m=Vn(x.pathname);return!!(c&&!m)});return u.useEffect(()=>{const x=m=>{c&&(m.preventDefault(),m.returnValue="")};return window.addEventListener("beforeunload",x),()=>{window.removeEventListener("beforeunload",x)}},[g.state,c]),{ConfirmModal:()=>{function x(){g?.reset&&g.reset()}function m(){l().then(()=>{g?.proceed?.()})}function w(){y(!0);const I=O.getState().workingProject;I?ua({projectData:I}).then(()=>{ce.success("Project saved successfully"),g?.proceed&&g.proceed(),l()}).catch(j=>{console.error(j),ce.error("Error while saving project")}):(ce.error("Error while saving project: not found"),y(!1))}const[b,y]=u.useState(!1);return g.state==="blocked"?e.jsx(oe,{maskClosable:!1,title:e.jsxs("div",{style:{color:"rgb(255 113 77)"},children:[e.jsx(pe,{})," Unsaved changes"]}),open:!0,onCancel:()=>{x()},footer:[e.jsx(P,{onClick:()=>x(),children:"Stay here"},"back"),e.jsx(P,{loading:b,type:"primary",onClick:()=>w(),children:"Save and exit"},"saveAndExit"),e.jsx(P,{type:"primary",danger:!0,onClick:()=>m(),children:"Leave without saving"},"submit")],children:e.jsx("div",{children:"Are you really want to leave editor? All unsaved changes will be lost."})}):null}}},{Option:Bn}=_e,xe=me.memo(({name:t,envIndex:a,label:o,placeholder:l,rules:v,addonAfter:c,form:g,setIsFormChanged:f})=>{const x=typeof a!="number",m=g.getFieldValue(["env",a,...t]),[w,b]=u.useState(m!==void 0),y=I=>{I?g.setFieldValue(["env",a,...t],""):g.setFieldValue(["env",a,...t],void 0),b(I),f(!0)};return x?e.jsx(p.Item,{isListField:!1,label:o,colon:!1,required:!1,name:[...t],rules:v,children:e.jsx(z,{addonAfter:c,placeholder:l})}):e.jsx(p.Item,{colon:!1,label:o,children:e.jsxs(nt,{style:{flexWrap:"nowrap"},gutter:8,children:[e.jsx(Se,{flex:"auto",children:e.jsx(p.Item,{noStyle:!0,isListField:w,label:o,colon:!1,required:!1,name:w?["env",a,...t]:t,rules:v,children:e.jsx(z,{disabled:!w,addonAfter:c,placeholder:l,addonBefore:w?null:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray"},children:"inherited"})})})}),e.jsx(Se,{style:{alignSelf:"center"},children:e.jsx(de,{onChange:I=>{y(I)},checked:w,size:"small"})})]})})}),Ct=me.memo(({form:t,envIndex:a,setIsFormChanged:o})=>{const l=typeof a!="number";return e.jsxs(e.Fragment,{children:[l?e.jsx(p.Item,{colon:!0,label:"Environment name",children:e.jsx("div",{children:"Default"})}):e.jsx(p.Item,{isListField:!0,colon:!1,required:!1,name:["env",a,"envName"],label:"Environment name",children:e.jsx(z,{placeholder:"Environment name"})}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Build Options"})}),e.jsx(p.Item,{isListField:!l,colon:!1,required:!1,label:"Enable console",valuePropName:"checked",name:l?["debugOptions","showConsoleOnLoad"]:["env",a,"debugOptions","showConsoleOnLoad"],children:e.jsx(de,{})}),e.jsx(xe,{setIsFormChanged:o,form:t,label:"Archive Name",placeholder:"Archive Name",envIndex:a,name:["archiveName"],rules:[()=>({validator(v,c){return He(c)}})],addonAfter:".ch5z"}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Connection Options"})}),e.jsx(xe,{setIsFormChanged:o,form:t,label:"Host",placeholder:"Ip or Hostname",envIndex:a,name:["webXpanel","host"]}),e.jsx(xe,{setIsFormChanged:o,label:"ipId",form:t,placeholder:"IpId",envIndex:a,name:["webXpanel","ipId"]}),e.jsx(xe,{setIsFormChanged:o,label:"Room ID",form:t,placeholder:"Room ID",envIndex:a,name:["webXpanel","roomId"]}),e.jsx(xe,{setIsFormChanged:o,label:"Auth Token",form:t,placeholder:"Auth Token",envIndex:a,name:["webXpanel","authToken"]}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Dataset Options"})}),e.jsx(xe,{setIsFormChanged:o,label:"Dataset base URL",placeholder:"Dataset base URL",form:t,envIndex:a,name:["datasetOptions","hostname"]}),e.jsx(xe,{setIsFormChanged:o,label:"Authorization header key",placeholder:"Authorization header key",form:t,envIndex:a,name:["datasetOptions","headerKey"]}),e.jsx(xe,{setIsFormChanged:o,label:"Authorization header value",placeholder:"Authorization header value",form:t,envIndex:a,name:["datasetOptions","headerValue"]})]})}),zn=me.memo(({editProjectModalId:t,setEditProjectModalId:a})=>{const o=Qt(_=>_.themesList),l=O.getState().workingProject,{name:v,theme:c,env:g,webXpanel:f,datasetOptions:x,debugOptions:m,archiveName:w,globalJoins:b,splashScreen:y}=l?.attributes??{},I={env:g,webXpanel:f,datasetOptions:x,debugOptions:m,archiveName:w,globalJoins:b,name:v,splashScreen:y,theme:c?.data.id},[j]=p.useForm(),A=p.useWatch("env",j),[M,D]=u.useState(!1),[G,B]=u.useState(!1),H=_=>{D(!0),console.log("formData",_),t&&Ot({projectId:t,inputData:_}).then(()=>{B(!1),ce.success("Project settings saved")}).finally(()=>D(!1))},J=()=>{G?zt({icon:e.jsx(pe,{}),title:"Exit project settings?",content:"Close without saving project settings?",okText:"Close without save",cancelText:"Cancel",okButtonProps:{danger:!0},onOk:()=>{D(!1),a(null)},onCancel:()=>{D(!1)}}):a(null)},{refreshSingleDataSource_signal_s_fb:N}=l?.attributes.globalJoins||{},R=()=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{children:"Project Settings"}),e.jsx(P,{icon:e.jsx(Dn,{}),loading:M,disabled:!G,onClick:()=>{j.submit()},type:"primary",children:"Save Project Settings"})]}),U=(_,Z)=>{if(!l||!t)return;const X=[...A??[]];if(Z==="add"){const d=an().format("YYYY-MM-DD_HH-mm"),n=Bt(),i={envName:"ENV_"+d,envId:n};X.push(i),j.setFieldValue("env",X),B(!0)}else if(Z==="remove"&&typeof _=="string")try{const d=Number(_);X.splice(d,1),j.setFieldValue("env",X),B(!0)}catch(d){console.log(d)}},W=()=>{const _={label:"Default",key:"Default",forceRender:!0,children:e.jsx(Ct,{setIsFormChanged:B,form:j})},X=(A??[]).map((d,n)=>({label:d.envName||"no_name",key:String(n),forceRender:!0,children:e.jsx(Ct,{setIsFormChanged:B,form:j,envIndex:n})}));return[_,...X]};return l?e.jsx(Ka,{closable:!0,maskClosable:!0,width:"min(600px, 85vw)",title:e.jsx(R,{}),placement:"right",onClose:()=>{J()},destroyOnClose:!0,open:t!==null,children:e.jsxs(p,{onValuesChange:_=>{B(!0),console.log(j.getFieldsValue())},style:{maxHeight:"100%",overflowY:"auto"},labelCol:{xs:{span:8}},wrapperCol:{xs:{span:14}},form:j,initialValues:I,onFinish:H,scrollToFirstError:!0,children:[e.jsx(p.Item,{colon:!1,required:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."}],children:e.jsx(z,{})}),e.jsx(p.Item,{colon:!1,required:!1,name:"theme",label:"Theme",rules:[{required:!0,message:"This field is required."}],children:e.jsx(_e,{children:o?.map(_=>e.jsx(Bn,{value:_.id,children:_.attributes.name},_.id))})}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Global joins"})}),e.jsx(p.Item,{colon:!1,required:!1,name:["globalJoins","analogPageFlip_signal_a_fb"],label:"Analog flip page signal",children:e.jsx(z,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"a"})}),placeholder:"Analog signal name"})}),e.jsx(p.Item,{colon:!1,required:!1,name:["globalJoins","serialPageFlip_signal_s_fb"],label:"Serial flip page signal",children:e.jsx(z,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(p.Item,{colon:!1,required:!1,name:["globalJoins","notification_signal_s_fb"],label:"Notification signal",children:e.jsx(z,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(p.Item,{colon:!1,required:!1,name:["globalJoins","refreshDataSources_signal_d_fb"],label:"Refresh All DataSources",children:e.jsx(z,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"d"})}),placeholder:"Digital signal name"})}),e.jsx(p.Item,{colon:!1,initialValue:N,required:!1,name:["globalJoins","refreshSingleDataSource_signal_s_fb"],label:"Refresh Single DataSource",children:e.jsx(z,{addonBefore:e.jsx("div",{style:{marginRight:0,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:"s"})}),placeholder:"Serial signal name"})}),e.jsx(te,{plain:!0,orientation:"left",children:e.jsx("span",{style:{textTransform:"uppercase",fontSize:10,opacity:.7},children:"Splash screen options"})}),e.jsx(p.Item,{colon:!1,initialValue:N,required:!1,name:["splashScreen","logoImgId"],label:"Logo image ID",children:e.jsx(z,{placeholder:"Image id from library"})}),e.jsx(p.Item,{colon:!1,initialValue:N,required:!1,name:["splashScreen","text"],label:"Text",children:e.jsx(z,{placeholder:"Splash screen text"})}),e.jsx(te,{plain:!0}),e.jsx("div",{style:{fontSize:14,fontWeight:500,paddingBottom:20},children:"Project Environments"}),e.jsx(p.List,{name:"env",children:()=>null}),e.jsx(Ie,{destroyInactiveTabPane:!1,className:"envProjectTabs",size:"small",type:"editable-card",onEdit:U,items:W()})]})}):null}),{Panel:qn}=Re,Gn=Ve(oe)`
  height: calc(100vh - 4%) !important;
  width: 100% !important;

  .ant-modal-content {
    height: 100%;
    position: relative;
    display: flex;
    flex-flow: column;

    .dsForm {
      height: 100%;
      flex: 1;
      position: relative;
      display: flex;
      flex-flow: column;
    }

    .ant-modal-body {
      flex: 1;
      position: relative;
      padding: 0;
      display: flex;
      flex-flow: column;
    }

    .ant-collapse-header {
      font-weight: normal !important;
      user-select: none;
      text-transform: uppercase;
      font-size: 12px;
    }

    .ant-form-item-label {
      flex-basis: 160px;
    }
  }
`,qe=Ve.div`
  position: relative;
  height: 100%;
  padding-top: 17px;
  /* overflow: hidden; */
  min-height: 200px;

  .monaco-editor {
    position: absolute !important;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    width: 100%;
    height: 100%;
  }
`,Hn=Ve(Ie)`
  position: relative;
  flex: 1;

  .ant-tabs-content {
    position: relative;
    height: 100%;
  }

  .ant-tabs-tabpane {
    height: 100%;
    background-color: #1e1e1e;
  }

  .ant-tabs-nav {
    margin: 0;
  }

  .ant-tabs-tab {
    border: 0 !important;

    &.ant-tabs-tab-active {
      background-color: #1e1e1e;

      .ant-tabs-tab-btn {
        color: #fff;
        user-select: none;
      }
    }
  }
`,St=Ve.div`
  color: #fff;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
`,Un=Ve.div`
  position: relative;
  display: flex;
  color: #fff;
  height: 100%;

  .functionBox {
    min-width: 300px;
    position: relative;
    height: 100%;
    display: flex;
    flex-flow: column;

    .functionBoxControls {
      padding: 17px;
      padding-right: 0;
      padding-bottom: 0;
      font-size: 12px;
      display: flex;
      gap: 5px;
      justify-content: space-between;
    }
  }

  .resultBox {
    flex: 1;
  }
`,Wn=({setNewDatasourceVisible:t,newDatasourceVisible:a})=>{const o=typeof a=="number"?a:null,l=O.getState().workingProject?.attributes.datasources.data.find(k=>k.id===o),v=O.getState().workingProject?.attributes.modificators.data,[c]=p.useForm(),{projectId:g}=ee(),f=u.useMemo(()=>{let k=O.getState().workingProject?.attributes.datasources.data??[];return l&&(k=k.filter(V=>V.id!==l.id)),k.map(V=>V.attributes.name)},[l]),x=u.useMemo(()=>O.getState().workingProject?.attributes.modificators.data?.map(V=>({value:V.id,label:V.attributes.name}))??[],[]),{headerKey:m,headerValue:w,hostname:b}=ma()??{},[y,I]=u.useState("local"),[j,A]=u.useState(null),[M,D]=u.useState(null),G=p.useWatch("sourceLink",c),B=p.useWatch("useBaseUrl",c),H=p.useWatch("headerKey",c),J=p.useWatch("headerValue",c),N=H!==null,R=J!==null,U=p.useWatch("sourceObject",c),W=p.useWatch("modificatorId",c),_=!!G||!!B,[Z,X]=u.useState(!1),[d,n]=u.useState(!1),[r,i]=u.useState("local"),s=ha({data:{useBaseUrl:B,sourceLink:G,headerKey:H,headerValue:J}}),h=u.useMemo(()=>_&&!U?"remote":_&&U?"mixed":"local",[_,U]),C=u.useMemo(()=>W?v?.find(k=>k.id===W):null,[W,v]),S=u.useCallback(()=>{C&&(c.setFieldValue("modificatorFunctionString",C.attributes.function),n(!1))},[c,C]);u.useEffect(()=>{S()},[S]);const[E,T]=u.useState(!1),[F,$]=u.useState([]),[q,ve]=u.useState([]),ie=k=>{$(k)},Te=k=>{ve(k)},L=({formKey:k,value:Y})=>{const V=c.getFieldValue(k);function re(){c.setFieldsValue({[k]:Y?"":null})}!Y&&V?zt({icon:e.jsx(pe,{}),title:"Are you sure?",content:"Disabling this option will clear the value of the field. Are you sure you want to proceed?",okButtonProps:{danger:!0},okText:"Proceed",cancelText:"Cancel",onOk:()=>{re()},onCancel:()=>{}}):re()},ne=async k=>{if(!g)return;const{name:Y,sourceLink:V,useBaseUrl:re,headerKey:be,headerValue:Pe,modificatorId:Xe,sourceObject:Ye,modificatorFunctionString:Fe,isImagePreloadSource:Le}=k;console.log("formData",k);let Ee={name:Y||"New datasouce",production:{sourceLink:V,useBaseUrl:re,headerKey:be,headerValue:Pe,modificatorId:Xe||null,sourceObject:Ye,storageType:h,isImagePreloadSource:Le},uid:Bt()};if(T(!0),d&&C?.id&&await Yt({function:Fe},C.id).catch(()=>{ce.error("Failed to update function"),T(!1)}),l){const{uid:Be,...ra}=Ee;ga({...ra},l.id).then(()=>t(!1)).then(()=>pt()).finally(()=>T(!1))}else pa(g,Ee).then(()=>t(!1)).then(()=>pt()).finally(()=>T(!1))},he=u.useCallback(()=>F.length>0?e.jsx(ge,{trigger:"hover",title:"invalid JSON",content:"JSON data contains errors",children:e.jsx(pe,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})}):null,[F.length]);function we(){const k=new Date,Y=k.getFullYear(),V=String(k.getMonth()+1).padStart(2,"0"),re=String(k.getDate()).padStart(2,"0"),be=String(k.getHours()).padStart(2,"0"),Pe=String(k.getMinutes()).padStart(2,"0");return`${Y}-${V}-${re}_${be}-${Pe}`}const Me=we(),Ke=l?{name:l.attributes.name,sourceLink:l.attributes.production?.sourceLink??"",useBaseUrl:l.attributes.production?.useBaseUrl??!1,headerKey:l.attributes.production?.headerKey??null,headerValue:l.attributes.production?.headerValue??null,modificatorId:l.attributes.production?.modificatorId??0,sourceObject:l.attributes.production?.sourceObject??"",modificatorFunctionString:"",isImagePreloadSource:l.attributes.production?.isImagePreloadSource??!1}:{name:"New datasource "+Me,sourceLink:"",useBaseUrl:!1,headerKey:null,headerValue:null,modificatorId:0,sourceObject:"",modificatorFunctionString:"",isImagePreloadSource:!1},le=u.useCallback(async({beforeFetch:k,successFetch:Y,errorFetch:V,finallyFetch:re,applyFunction:be})=>{k();const{sourceLink:Pe,headerKey:Xe,headerValue:Ye}=s;try{await fa(Pe,Xe,Ye).then(Fe=>{let Le="";if(be){const Ee=c.getFieldValue("modificatorFunctionString");if(Ee)try{const Be=gt([Fe],null,void 0,Ee);console.log("dataAfterFunctionApply",Be),Le=JSON.stringify(Be,null,2)}catch{}}else Le=JSON.stringify(Fe,null,2);Y(Le)})}catch{ce.error("Failed to fetch data"),V()}finally{re?.()}},[s,c]);u.useEffect(()=>{y==="remote"&&!_&&I("local"),y==="modified"&&!W&&I("local"),D(null)},[y,_,W]);const Je=u.useMemo(()=>{const k=()=>{D("loading");try{const V=c.getFieldValue("modificatorFunctionString"),re=JSON.parse(U),be=gt([re],null,void 0,V);D(JSON.stringify(be,null,2))}catch(V){console.log(V),D(null)}},Y=()=>{if(r==="local")return U?e.jsx(P,{style:{textTransform:"capitalize"},icon:e.jsx(tt,{}),loading:M==="loading",onClick:()=>{k()},ghost:!0,children:"Calculate Local Modified Data"}):e.jsx("p",{children:"Your local source is empty"});if(r==="remote")return _?e.jsx(P,{style:{textTransform:"capitalize"},icon:e.jsx(tt,{}),loading:M==="loading",onClick:()=>le({applyFunction:!0,beforeFetch:()=>{D("loading")},successFetch:V=>{D(V)},errorFetch:()=>{D(null)}}),ghost:!0,children:"Calculate Remote Modified Data"}):e.jsx("p",{children:"Remote URL is not presented in ENV or datasource settings"})};return[{label:e.jsxs(e.Fragment,{children:["Set Local Source ",he()]}),key:"local",children:e.jsx(qe,{hasErrors:!!F.length,children:e.jsx(p.Item,{noStyle:!0,name:"sourceObject",validateStatus:F.length?"error":void 0,rules:[()=>({validator(V,re){return F.length?Promise.reject():Promise.resolve()}})],normalize:V=>V===void 0?"":V,children:e.jsx(ye,{className:"monaco-editor",language:"json",loading:e.jsx(je,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",onValidate:ie})})})},{label:"Test Remote Source",disabled:!_,key:"remote",children:j===null||j==="loading"?e.jsx(St,{children:e.jsx(P,{icon:e.jsx(tt,{}),loading:j==="loading",onClick:()=>le({beforeFetch:()=>{A("loading")},successFetch:V=>{A(V)},errorFetch:()=>{A(null)}}),ghost:!0,children:"Retreive Remote Data"})}):e.jsx(qe,{hasErrors:!!F.length,children:e.jsx(ye,{className:"monaco-editor",language:"json",loading:e.jsx(je,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",value:j})})},{label:e.jsxs(e.Fragment,{children:["Test Function",!!q.length&&e.jsx(ge,{trigger:"hover",title:"invalid Function",content:"Function contains errors",children:e.jsx(pe,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})})]}),disabled:!W,key:"modified",children:e.jsxs(Un,{children:[e.jsx("div",{className:"functionBox",children:e.jsx("div",{style:{flex:1},children:e.jsx(qe,{hasErrors:!1,children:e.jsx(p.Item,{name:"modificatorFunctionString",validateStatus:q.length?"error":void 0,rules:[()=>({validator(V,re){return q.length?Promise.reject():Promise.resolve()}})],normalize:V=>V===void 0?"":V,noStyle:!0,children:e.jsx(ye,{className:"monaco-editor",language:"json",loading:e.jsx(je,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",lineNumbers:"off",wordWrap:"on",glyphMargin:!1,folding:!0,lineDecorationsWidth:0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"javascript",onValidate:Te})})})})}),e.jsx("div",{className:"resultBox",children:M===null||M==="loading"?e.jsx(St,{children:e.jsx(Y,{})}):e.jsx(qe,{hasErrors:!!F.length,children:e.jsx(ye,{className:"monaco-editor",language:"json",loading:e.jsx(je,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"json",value:M})})})]})}]},[F.length,he,c,q.length,le,_,W,M,r,U,j]),Oe=u.useMemo(()=>{switch(y){case"local":return e.jsxs(e.Fragment,{children:[e.jsx(P,{size:"small",disabled:!_,icon:e.jsx(Tn,{}),type:"dashed",style:{marginLeft:10},loading:Z,onClick:()=>le({beforeFetch:()=>{X(!0)},successFetch:k=>{c.setFieldsValue({sourceObject:k})},errorFetch:()=>{},finallyFetch:()=>{X(!1)}}),children:"Fill from remote source"}),e.jsx(P,{size:"small",onClick:()=>{c.setFieldsValue({sourceObject:null})},disabled:!(U&&!Z),danger:!0,icon:e.jsx(ke,{}),type:"dashed",style:{marginLeft:10},children:"Clear"})]});case"remote":return e.jsxs(e.Fragment,{children:[e.jsx(P,{onClick:()=>le({beforeFetch:()=>{A("loading")},successFetch:k=>{A(k)},errorFetch:()=>{A(null)}}),loading:j==="loading",size:"small",icon:e.jsx(Ja,{}),type:"dashed",style:{marginLeft:10},disabled:j===null||j==="loading",children:"Refresh Remote Data"}),e.jsx(P,{size:"small",onClick:()=>{A(null)},disabled:j===null||j==="loading",danger:!0,icon:e.jsx(ke,{}),type:"dashed",style:{marginLeft:10},children:"Clear Preview"})]});case"modified":return e.jsxs(e.Fragment,{children:[e.jsx(P,{onClick:()=>D(null),loading:M==="loading",size:"small",icon:e.jsx(ke,{}),type:"dashed",style:{marginLeft:10},disabled:M===null||M==="loading",children:"Clear"}),e.jsx(P,{size:"small",onClick:()=>S(),disabled:!d,danger:!0,icon:e.jsx(ke,{}),type:"dashed",style:{marginLeft:10},children:"Discard function changes"}),e.jsx(_e,{size:"small",value:r,style:{marginLeft:10},onChange:k=>{i(k),D(null)},options:[{value:"local",label:"Use Local Source"},{value:"remote",label:"Use Remote Source"}]})]});default:return null}},[y,Z,c,le,d,_,M,r,S,U,j]),Ze=k=>{const Y=Object.keys(k);Y.includes("modificatorFunctionString")&&!d&&n(!0),Y.includes("modificatorId")&&(n(!1),D(null))};return e.jsx(Gn,{destroyOnClose:!0,maskClosable:!1,centered:!0,title:l?`Edit datasource: ${l.attributes.name}`:"Add new datasource",open:!0,onCancel:()=>t(!1),footer:[e.jsx(P,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsxs(P,{loading:E,type:"primary",onClick:()=>{c.submit()},children:[l?"Save datasource":"Add datasource"," ",d?"& Update Function":""]},"submit")],children:e.jsxs(p,{onValuesChange:Ze,onFinish:ne,className:"dsForm",form:c,initialValues:Ke,scrollToFirstError:!0,children:[e.jsx(Re,{destroyInactivePanel:!1,expandIcon:({isActive:k})=>k?e.jsx(Ht,{}):e.jsx(Ut,{}),defaultActiveKey:o?[]:["form"],ghost:!0,children:e.jsxs(qn,{forceRender:!0,extra:e.jsx(dt,{color:h==="local"?"gold":"green",style:{marginInlineEnd:0,textTransform:"none"},children:h}),header:"DataSource Settings",children:[e.jsx(p.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(k,Y){return Promise.all([Ae({input:Y,searchArray:f})])}})],children:e.jsx(z,{})}),e.jsx(te,{plain:!0,orientationMargin:160,orientation:"left",children:"Remote fetch settings"}),e.jsx(p.Item,{colon:!1,required:!1,label:"Remote URL",name:"sourceLink",children:e.jsx(p.Item,{noStyle:!0,colon:!1,required:!1,name:"sourceLink",normalize:k=>k===void 0?"":k,children:e.jsx(z,{allowClear:!0,spellCheck:!1,placeholder:B?"End of URL":"URL",addonBefore:e.jsxs(e.Fragment,{children:[e.jsx(p.Item,{valuePropName:"checked",name:"useBaseUrl",noStyle:!0,children:e.jsx(qt,{children:e.jsx("span",{style:{userSelect:"none"},children:"Include Base Url"})})}),e.jsx(ge,{content:e.jsxs(e.Fragment,{children:["BaseUrl: ",b||"Empty"]}),children:e.jsx(Gt,{})})]})})})}),_&&e.jsxs(e.Fragment,{children:[e.jsx(p.Item,{label:"Request Header key",colon:!1,children:e.jsxs(nt,{gutter:8,children:[e.jsx(Se,{flex:"auto",children:e.jsx(p.Item,{colon:!1,required:!1,noStyle:!0,name:"headerKey",normalize:k=>k===void 0?"":k,children:e.jsx(z,{addonBefore:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray",width:70,cursor:"default"},children:N?"custom key":e.jsx(Ue,{placement:"topLeft",title:"Value inherited from Project Environment settings",arrowPointAtCenter:!0,children:"inherited"})}),placeholder:N?"Empty":m||"Empty",allowClear:!0,spellCheck:!1,disabled:!N})})}),e.jsx(Se,{style:{alignSelf:"center"},children:e.jsx(p.Item,{noStyle:!0,colon:!1,required:!1,valuePropName:"checked",children:e.jsx(de,{onChange:k=>{L({formKey:"headerKey",value:k})},checked:N,size:"small"})})})]})}),e.jsx(p.Item,{label:"Request Header value",colon:!1,children:e.jsxs(nt,{gutter:8,children:[e.jsx(Se,{flex:"auto",children:e.jsx(p.Item,{colon:!1,required:!1,noStyle:!0,name:"headerValue",normalize:k=>k===void 0?"":k,children:e.jsx(z,{addonBefore:e.jsx("div",{style:{textTransform:"uppercase",fontSize:9,color:"gray",width:70,cursor:"default"},children:R?"custom value":e.jsx(Ue,{placement:"topLeft",title:"Value inherited from Project Environment settings",arrowPointAtCenter:!0,children:"inherited"})}),placeholder:R?"Empty":w||"Empty",allowClear:!0,spellCheck:!1,disabled:!R})})}),e.jsx(Se,{style:{alignSelf:"center"},children:e.jsx(p.Item,{noStyle:!0,colon:!1,required:!1,valuePropName:"checked",children:e.jsx(de,{onChange:k=>{L({formKey:"headerValue",value:k})},checked:R,size:"small"})})})]})})]}),e.jsx(te,{plain:!0,orientationMargin:160,orientation:"left",children:"Datasource postprocessing & manipulation"}),e.jsx(p.Item,{colon:!1,required:!1,label:"Modify Function",name:"modificatorId",children:e.jsx(_e,{options:[{value:0,label:"None"},...x]})}),e.jsx(p.Item,{colon:!1,required:!1,label:e.jsxs("div",{style:{width:200},children:["Image preload",e.jsx(ge,{placement:"topLeft",title:"Datasource for Image preloading",content:"URLs array will be used to preload & cache images",trigger:"hover",arrowPointAtCenter:!0,children:e.jsx(We,{style:{marginLeft:7}})})]}),name:"isImagePreloadSource",valuePropName:"checked",children:e.jsx(de,{})})]},"form")}),e.jsx(Hn,{activeKey:y,onChange:k=>{I(k)},tabBarExtraContent:{right:e.jsx("div",{style:{paddingRight:17},children:Oe})},animated:!1,type:"card",items:Je})]})})},$n=({setNewGlobalContainerVisible:t,newGlobalContainerVisible:a})=>{const{projectId:o}=ee(),[l,v]=u.useState(!1),g=O(b=>b.workingProject)?.attributes.globalContainers;function f(b){return!g?.some(y=>y.name===b)}const[x]=p.useForm(),m=()=>{x.submit()},w=({name:b,visibleByDefault:y,position:I})=>{v(!0);let A=[{name:b||"Global Container",visibleByDefault:y===void 0?!0:y,visibleOnPages:[],hiddenOnPages:[],elements:[],useOrientation:!1,cssClass:"globalContainer",landscapePosition:I||"top",portraitPosition:I||"top",landscape:{flow:"row",padding:{value:void 0,unit:"%"},gap:{value:void 0,unit:"%"},align:"center",distribution:"center",border:null,size:{manualMode:!1,value:void 0,unit:"%"},backgroundColor:""},portrait:{flow:"row",padding:{value:void 0,unit:"%"},gap:{value:void 0,unit:"%"},align:"center",distribution:"center",border:null,size:{manualMode:!1,value:void 0,unit:"%"},backgroundColor:""}}];g&&Array.isArray(g)&&(A=[...g,...A]),o&&Ot({projectId:o,inputData:{globalContainers:A}}).then(()=>{t(!1)}).finally(()=>{v(!1)})};return e.jsx("div",{onKeyUp:b=>{b.key==="Enter"&&m()},children:e.jsx(oe,{afterClose:()=>x.resetFields(),maskClosable:!1,title:"Add New Global Container",open:!0,onCancel:()=>t(!1),footer:[e.jsx(P,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsx(P,{loading:l,type:"primary",onClick:m,children:"Add global container"},"submit")],children:e.jsxs(p,{labelCol:{xs:{span:8}},wrapperCol:{xs:{span:14}},form:x,onFinish:w,initialValues:{name:"Global Container",visibleByDefault:!0},scrollToFirstError:!0,children:[e.jsx(p.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(b,y){return y&&f(y)?Promise.resolve():Promise.reject(new Error("Container name must be unique"))}})],children:e.jsx(z,{})}),e.jsx(p.Item,{colon:!1,required:!1,name:"position",label:"Default Position",initialValue:"top",children:e.jsx(_e,{style:{width:"100%"},options:[{value:"top",label:"Top"},{value:"right",label:"Right"},{value:"bottom",label:"Bottom"},{value:"left",label:"Left"}]})}),e.jsx(p.Item,{colon:!1,required:!1,name:"visibleByDefault",label:"Default Visibility",valuePropName:"checked",children:e.jsx(de,{checkedChildren:"Visible",unCheckedChildren:"Hidden"})})]})})})},Kn=({functionString:t})=>{const a={variablesUsed:[],statesUsed:[],datasourceUsed:[]};if(!t)return a;const o=t.replace(/\s+/g,"");if(/getVariableByName\(\{name:\s*([^\s'"]+)\}/.test(o))a.variablesUsed="*";else{const c=/getVariableByName\(\{name:\s*['"]([^'"]+)['"]\}\)/g,g=[];let f;for(;(f=c.exec(o))!==null;)g.push(f[1]);a.variablesUsed=[...new Set(g)]}return/window\?.avgatorStudio\?.getStoreValue/g.test(o)&&(a.statesUsed="*"),console.log("extractUsedDynamicFromFunction result",a),a};var Jn="newModificatorModal_dsTabs__hs8w7r0",kt="newModificatorModal_modificatorModal__hs8w7r1",_t="newModificatorModal_modificatorCreatingEditor__hs8w7r2",Zn="newModificatorModal_modificatorEditorsRow__hs8w7r3",Xn="newModificatorModal_createModificatorColumn__hs8w7r4",Yn="newModificatorModal_testModificatorColumn__hs8w7r5",Qn="newModificatorModal_argumentTabLabel__hs8w7r6";const{Panel:It}=Re,Ge=function(a){return a.trim().toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(o,l)=>l.toUpperCase())},er=({setNewModificatorVisible:t,newModificatorVisible:a})=>{const o=typeof a=="number"?a:null,l=O.getState().workingProject?.attributes.modificators.data.find(s=>s.id===o),[v,c]=u.useState(!1),{projectId:g}=ee(),[f,x]=u.useState([]),[m]=p.useForm(),w=p.useWatch("name",m),b="RunFunction",[y,I]=u.useState(b),j=p.useWatch("argumentsTestData",m),{addValueToStore:A,getValueFromStore:M}=va.getState(),{setVariableNewValue:D}=xa.getState(),G=u.useRef(null),B=s=>{G.current=s,s.onKeyDown(h=>{const C=G.current&&G.current.getPosition().lineNumber,S=G.current&&G.current.getModel().getLineCount(),E=G.current.getSelection(),{startLineNumber:T,endLineNumber:F,selectionStartLineNumber:$}=E;(C===1||C===S||T===1||T===S||F===1||F===S||$===1||$===S)&&(h.stopPropagation(),h.preventDefault())})},H=u.useRef(null),J=s=>{H.current=s},N=()=>`arg${j.length+1}`,R=s=>{try{const h=[...j];h[s].testData="",m.setFieldsValue({argumentsTestData:h})}catch(h){console.log(h)}},U=()=>new Promise((s,h)=>{const C=m.getFieldValue("function");if(!C){h(new Error("No function found."));return}let S=!0;const E=j?.map(T=>{T?.testData||(S=!1);const F=T?.testData;try{return JSON.parse(F)}catch{return F}})||[];try{const T=vt(C);if(console.log("userFunction",T),S){let F=T(...E,xt(),A,M,D);typeof F=="object"?F=JSON.stringify(F):F=String(F),H.current?.getModel().setValue(F),s(F)}else s("No arguments")}catch(T){console.error("Error when calling finalFunction:",T);const F=`Error when calling ${Ge(w??"")}: ${T?.message}`;H.current?.getModel().setValue(F),h(T)}}),W=()=>new Promise((s,h)=>{const C=m.getFieldValue("function");if(!C){h(new Error("No function found."));return}const S=j?.map(E=>{const T=E?.testData;try{return JSON.parse(T)}catch{return T}})||[];try{let T=vt(C)(...S,xt(),A,M,D);typeof T=="object"?T=JSON.stringify(T):T=String(T),H.current?.getModel().setValue(T),s(T)}catch(E){console.error("Error when calling finalFunction:",E);const T=`Error when calling ${Ge(w??"")}: ${E?.message}`;H.current?.getModel().setValue(T),h(E)}}),_=()=>{if(y===b)return e.jsxs("div",{style:{paddingRight:17,display:"flex",gap:5},children:[e.jsx(P,{onClick:()=>{W().catch(C=>{console.log(C)})},icon:e.jsx(Fn,{}),ghost:!0,type:"primary",children:"Run"}),e.jsx(P,{onClick:()=>{H.current?.getModel().setValue("")},danger:!0,icon:e.jsx(ke,{}),type:"dashed"})]});const s=Number(y.split("_")[1]),h=!!j?.[s]?.testData;return e.jsx("div",{style:{paddingRight:17},children:e.jsx(P,{disabled:!h,onClick:()=>{R(s)},danger:!0,icon:e.jsx(ke,{}),type:"dashed"})})};u.useEffect(()=>{if(y===b)return;const s=Number(y.split("_")[1]);j?.[s]||I(b)},[j,y]),u.useEffect(()=>{if(!w)return;const s=m.getFieldValue("function");if(!s)return;const h=j?.map(E=>E.name)??[],C=s.split(`
`),S=`function ${Ge(w)}(${h.join(",")}){`;C[0]=S,m.setFieldsValue({function:C.join(`
`)})},[m,w,j]);const Z=u.useMemo(()=>{let s=[];return!j?.length||j?.some(h=>h===void 0)?s=[]:s=j?.map((h,C)=>({label:e.jsxs("div",{className:Qn,children:[e.jsx("small",{children:"test data"}),h.name]}),key:`argument_${C}`,children:e.jsx("div",{className:_t,children:e.jsx(p.Item,{isListField:!0,preserve:!1,noStyle:!0,name:["argumentsTestData",C,"testData"],validateStatus:"success",normalize:S=>S===void 0?"":S,children:e.jsx(ye,{className:"monaco-editor",loading:e.jsx(je,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark"})},C)})})),[{label:"Test Function",key:"RunFunction",children:e.jsx("div",{className:_t,children:e.jsx(ye,{value:"",onMount:J,className:"monaco-editor",language:"javascript",loading:e.jsx(je,{}),options:{readOnly:!0,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0}},theme:"vs-dark",defaultLanguage:"javascript"})},"RunFunctionKey")},...s??[]]},[j]),X=()=>{m.submit()},d=({name:s,function:h,argumentsTestData:C})=>{c(!0),U().then(()=>{const S=Kn({functionString:h}),E={name:s||"New function",function:h,dynamicDataUsed:S};o?Yt({...E},o).then(()=>{t(!1)}):g&&nn(g,{...E,argumentsTestData:C}).then(()=>{t(!1)})}).catch(S=>{I(b),ce.error(`Function test failed: ${S.message}`),console.log(S)}).finally(()=>{c(!1)})},n=l?{name:l.attributes.name,function:l.attributes.function,argumentsTestData:l.attributes.function.substring(l.attributes.function.indexOf("(")+1,l.attributes.function.indexOf(")")).trim()===""?[]:l.attributes.function.substring(l.attributes.function.indexOf("(")+1,l.attributes.function.indexOf(")")).split(",").map(s=>({name:s.trim(),testData:null}))}:{name:"My function",function:[`function ${Ge("My function")}(){`,"//write your code here","","}"].join(`
`),argumentsTestData:[]},r=()=>f.length>0?e.jsx(ge,{trigger:"hover",title:"Validation error",content:"Function contains errors",children:e.jsx(pe,{style:{fontSize:14,margin:"0 0 0 5px",color:"red",cursor:"help"}})}):null,i=[{name:"Navigate",content:`
    //navigate - function to navigate by url path
    window?.avgatorStudio?.navigate("/path")
    //navigate - function to navigate by page name
    window?.avgatorStudio?.navigateToPage("my page name")
    `},{name:"Events",content:`
    //publishAnalog - function to publish analog signal
    window?.avgatorStudio?.publishAnalog({ signalName: "signalName", value: 1 })
    //publishDigital - function to publish digital signal
    window?.avgatorStudio?.publishDigital({ signalName: "signalName", value: true })
    //publishSerial - function to publish serial signal
    window?.avgatorStudio?.publishSerial({ signalName: "signalName", value: "value" })
    //getInstantDigitalFb - get instant digital feedback value
    window?.avgatorStudio?.getInstantDigitalFb({ signalName: "signalName", defaultValue: false })
    //getInstantAnalogFb - get instant analog feedback value
    window?.avgatorStudio?.getInstantAnalogFb({ signalName: "signalName", defaultValue: 0 })
    //getInstantSerialFb - get instant serial feedback value
    window?.avgatorStudio?.getInstantSerialFb({ signalName: "signalName", defaultValue: "text" })
      `},{name:"Get Datasource",content:`
    //getDatasource - function to get datasource value by uid. if no uid provided, returns all datasources
    const dataSource = window?.avgatorStudio?.getDatasource({ uid: '1234' });
      `},{name:"Variables",content:`
      //getVariableByName - function to get variable value by name
      const variableValue = window?.avgatorStudio?.getVariableByName({ name: 'variableName' });
      
      //setVariableByName - function to set variable value by name
      window?.avgatorStudio?.setVariableByName({ name: 'variableName', value: 'newValue' });
      `}];return e.jsx(oe,{className:kt,destroyOnClose:!0,maskClosable:!1,centered:!0,title:"Add new function",open:!0,onCancel:()=>t(!1),onOk:X,footer:[e.jsx(P,{onClick:()=>t(!1),children:"Cancel"},"back"),e.jsx(P,{disabled:f.length>0,loading:v,type:"primary",onClick:()=>{m.submit()},children:f.length>0?"Function contains errors":"Save"},"submit")],children:e.jsxs(p,{onFinish:d,className:"modificatorForm",form:m,initialValues:n,scrollToFirstError:!0,children:[e.jsx(Re,{destroyInactivePanel:!1,expandIcon:({isActive:s})=>s?e.jsx(Ht,{}):e.jsx(Ut,{}),defaultActiveKey:["form"],ghost:!0,children:e.jsx(It,{forceRender:!0,header:"Function Settings",children:e.jsxs("div",{style:{display:"flex",gap:20,alignItems:"stretch",height:"100%",position:"relative"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx(p.Item,{colon:!1,required:!1,label:"Name",name:"name",rules:[{required:!0,message:"This field is required."},()=>({validator(s,h){return Promise.all([Ae({input:h,searchArray:[]}),rt(h),st(h||"")])}})],children:e.jsx(z,{spellCheck:!1})}),e.jsx(te,{plain:!0,orientationMargin:160,orientation:"left",children:"Function Arguments"}),e.jsx(p.List,{name:"argumentsTestData",children:(s,{add:h,remove:C})=>e.jsxs(e.Fragment,{children:[s.map((S,E)=>{const{key:T,...F}=S;return e.jsxs("div",{style:{display:"flex",gap:10,alignItems:"flex-start",marginBottom:15},children:[e.jsx(p.Item,{...F,label:`Argument #${E+1}`,name:[S.name,"name"],validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"This field is required."},()=>({validator($,q){return Promise.all([Ae({input:q,searchArray:j.filter((ve,ie)=>ie!==E)||[],searchKey:"name"}),He(q),rt(q),st(q||"")])}})],style:{marginBottom:0,flex:1},children:e.jsx(z,{spellCheck:!1,autoFocus:!0})},T),e.jsx(ja,{style:{marginTop:10},onClick:()=>C(S.name)})]},S.key)}),e.jsx(p.Item,{label:" ",colon:!1,children:e.jsx(P,{type:"dashed",onClick:()=>h({name:N(),testData:void 0}),style:{width:"100%"},block:!0,icon:e.jsx(Wt,{}),children:"Add Function Argument"})})]})})]}),e.jsx("div",{style:{minWidth:"50%",width:"50%",position:"relative",overflow:"auto",translate:"0 -10px"},children:e.jsx(Re,{ghost:!0,accordion:!0,children:i.map(s=>e.jsx(It,{header:s.name,children:e.jsx(en,{wrapLongLines:!0,lineNumberContainerStyle:{display:"none"},lineNumberStyle:{display:"none"},style:{position:"relative",maxWidth:"100% !important",borderRadius:"3px"},language:"JavaScript",theme:"AtomOneDark",copy:!1,suppressContentWarning:!0,children:s.content})},s.name))})})]})},"form")}),e.jsxs("div",{className:Zn,children:[e.jsxs("div",{className:Xn,children:[e.jsxs(te,{plain:!0,orientationMargin:17,style:{paddingRight:17,marginBottom:9.5},orientation:"left",children:["Function Body editor",e.jsx(r,{})]}),e.jsx("div",{className:kt,children:e.jsx(p.Item,{noStyle:!0,name:"function",dependencies:["name"],validateStatus:f.length?"error":void 0,rules:[()=>({validator(s,h){return f.length?Promise.reject():Promise.resolve()}})],normalize:s=>s===void 0?"":s,children:e.jsx(ye,{onMount:B,className:"monaco-editor",language:"javascript",loading:e.jsx(je,{}),options:{readOnly:!1,automaticLayout:!0,hideCursorInOverviewRuler:!0,matchBrackets:"always",wordWrap:"on",glyphMargin:!1,folding:!0,lineNumbersMinChars:3,minimap:{enabled:!0},showUnused:!0},theme:"vs-dark",defaultLanguage:"javascript",onValidate:s=>{x(s)}})})})]}),e.jsx("div",{className:Yn,children:e.jsx(Ie,{className:Jn,activeKey:y,onChange:s=>{I(s)},tabBarExtraContent:{right:e.jsx(_,{})},animated:!1,type:"card",items:Z})})]})]})})},tr=({setNewPageModalVisible:t,newPageModalVisible:a})=>{const o=O.getState().workingProject?.attributes.pages.data||[],{projectId:l}=ee(),[v,c]=u.useState(!1),[g]=p.useForm(),f=()=>{g.submit()},x=a==="subpage",m=p.useWatch("isStatic",g),w=({name:b,isStatic:y})=>{if(c(!0),!l)return Promise.reject("No projectId");const I=x&&y?200:void 0;return rn({name:b,project:l,isSubpage:x,isStatic:!!y,width:{width:{value:I,unit:"px"}},height:{height:{value:I,unit:"px"}}}).then(()=>t(null)).finally(()=>c(!1))};return e.jsx(oe,{width:600,afterClose:()=>g.resetFields(),maskClosable:!1,title:`Add new ${a}`,open:!0,onCancel:()=>t(null),footer:[e.jsx(P,{onClick:()=>t(null),children:"Cancel"},"back"),e.jsxs(P,{loading:v,type:"primary",onClick:f,children:["Add new ",a]},"submit")],children:e.jsxs(p,{labelCol:{xs:{span:9}},wrapperCol:{xs:{span:12}},form:g,initialValues:{name:"page name",url:"mypage"},onFinish:w,scrollToFirstError:!0,children:[e.jsx(p.Item,{colon:!1,required:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."},()=>({validator(b,y){return Ae({input:y,searchArray:o,searchKey:["attributes","name"]})}})],children:e.jsx(z,{})}),e.jsx(te,{}),e.jsx(p.Item,{colon:!1,required:!1,name:"isStatic",initialValue:!0,label:"Design paradigm",children:e.jsx(tn,{children:({onChange:b,value:y,...I})=>e.jsx(Xt,{block:!0,style:{userSelect:"none"},onChange:j=>b(j==="true"),value:y?"true":"false",options:[{label:"Adaptive",value:"true",icon:e.jsx(lt,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:!0})},{label:"Responsive",value:"false",icon:e.jsx(lt,{style:{height:"auto",minWidth:"1em",margin:"0 3px -1px 0"},isStatic:!1})}],...I})})}),e.jsx(te,{}),e.jsxs("div",{style:{color:"var(--ant-primary-5)",fontSize:12,marginBottom:4},children:[e.jsx(We,{style:{fontSize:14}})," How"," ",m?"adaptive":"responsive"," page layout works"]}),m?e.jsx("p",{style:{fontSize:12},children:"Adaptive page layout allow you arrange elements manually by dragging ones. Element's position & size doesn't affect each other but optionally may depends on screen size and still be adaptive."}):e.jsx("p",{style:{fontSize:12},children:"Responsive page layout based on flexbox css model and all containers on the page with all elements inside are responsive."})]})})},ar=({setNewVariableModalVisible:t,newVariableModalVisible:a})=>{const o=a==="parameter",{projectId:l}=ee(),{pageId:v}=ee(),c=ht({pageId:v}),g=O(N=>N.workingProject),{variables:f=[]}=g?.attributes??{},{parameters:x=[]}=c?.attributes??{},[m]=p.useForm(),w=()=>{m.submit()},[b,y]=u.useState(!1),I=async({type:N,defaultValue_boolean:R,defaultValue_number:U,defaultValue_string:W,name:_,joinValueSetter_signal_fb:Z,waitForLoadingUi:X,formatValueFunctionUid:d})=>{let n={name:_,type:N,joinValueSetter_signal_fb:Z,formatValueFunctionUid:d};switch(n.type){case"boolean":n={...n,defaultValue:R==="true",waitForLoadingUi:X};break;case"string":n={...n,defaultValue:W};break;case"number":n={...n,defaultValue:U};break}y(!0);const r=n;try{await Ca({actionType:"create",variableData:r,projectId:l,pageId:v}),m.resetFields(),t(null),ce.success("Successfully created")}catch(i){console.log("Error creating",i),ce.error(i)}finally{y(!1)}},j={name:o?"newParameter":"newVariable",type:"boolean",defaultValue_boolean:"false",defaultValue_number:0,defaultValue_string:"",joinValueSetter_signal_fb:"",waitForLoadingUi:!1,formatValueFunctionUid:void 0},A={project:f,parameter:x},[M,D]=u.useState(j),G=u.useMemo(()=>o?"Create Subpage Parameter":"Create Project Variable",[o]),[B,H]=u.useState(!1),J=u.useMemo(()=>{const N=ba.getState().formatterFunctions[M.type??"boolean"];return N?.length?N.map(R=>{const{uid:U,name:W}=R;return{label:W,value:U}}):[]},[M.type]);return a?e.jsx(e.Fragment,{children:e.jsx(oe,{maskClosable:!1,title:G,open:!0,width:"50vw",onOk:w,onCancel:()=>t(null),footer:[e.jsx(P,{onClick:()=>t(null),children:"Cancel"},"back"),e.jsxs(P,{loading:b,type:"primary",onClick:w,children:["Create ",o?"Parameter":"Variable"]},"submit")],children:e.jsxs(p,{onValuesChange:N=>D({...M,...N}),labelCol:{xs:{span:9}},wrapperCol:{xs:{span:12}},form:m,initialValues:j,onFinish:I,scrollToFirstError:!0,children:[e.jsx(p.Item,{colon:!1,name:"name",label:"Name",rules:[{required:!0,message:"This field is required."},()=>({validator(N,R){return Promise.all([Ae({input:R,searchArray:A[a],searchKey:"name"}),He(R),rt(R),st(R)])}})],children:e.jsx(z,{spellCheck:!1})}),e.jsx(p.Item,{colon:!1,name:"type",label:"Type",rules:[{required:!1}],children:e.jsxs(fe.Group,{className:"radioFullWidth",buttonStyle:"solid",children:[e.jsx(fe.Button,{value:"boolean",children:"Boolean"}),e.jsx(fe.Button,{value:"string",children:"String"}),e.jsx(fe.Button,{value:"number",children:"Number"})]})}),M.type==="string"&&e.jsx(p.Item,{colon:!1,name:"defaultValue_string",label:"Default Value",children:e.jsx(z,{spellCheck:!1})}),M.type==="boolean"&&e.jsxs(e.Fragment,{children:[e.jsx(p.Item,{colon:!1,name:"defaultValue_boolean",label:"Default Value",children:e.jsx(Xt,{block:!0,options:["true","false"]})}),a==="project"&&e.jsx(p.Item,{label:"Use for loading UI (exprerimental)",name:"waitForLoadingUi",colon:!1,required:!1,valuePropName:"checked",help:"UI will not started until this variable is false",children:e.jsx(de,{})})]}),M.type==="number"&&e.jsx(p.Item,{colon:!1,name:"defaultValue_number",label:"Default Value",rules:[()=>({validator(N,R){return Promise.all([ya(R),wa(R)])}})],children:e.jsx(z,{style:{width:"100%"}})}),!o&&M.type&&e.jsx(p.Item,{extra:e.jsx(e.Fragment,{children:"Use signal feedback to modify variable"}),colon:!1,name:"joinValueSetter_signal_fb",label:e.jsx(e.Fragment,{children:"Set value Signal "}),rules:[()=>({validator(N,R){return He(R)}})],children:e.jsx(z,{suffix:e.jsx("div",{style:{marginRight:-5,marginTop:-2},children:e.jsx(Ce,{style:{margin:0},type:M.type,sub:"FB"})}),spellCheck:!1})}),e.jsx(p.Item,{colon:!1,label:e.jsx(e.Fragment,{}),children:e.jsx(qt,{checked:B,onChange:N=>H(N.target.checked),children:"Format output value"})}),B&&e.jsx(p.Item,{colon:!1,name:"formatValueFunctionUid",label:e.jsx(e.Fragment,{children:"Format value with function "}),children:e.jsx(_e,{allowClear:!0,style:{width:"100%",minWidth:"250px"},placeholder:"Select formatter function",showSearch:!0,filterOption:(N,R)=>R.label.toLowerCase().includes(N.toLowerCase()),options:J})})]})})}):null};var ea={},ta={},aa={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){for(var v=arguments.length,c=new Array(v),g=0;g<v;g++)c[g]=arguments[g];if(typeof window<"u"){var f;typeof window.gtag>"u"&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)}),(f=window).gtag.apply(f,c)}},o=a;t.default=o})(aa);var na={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=g;var a=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;function o(f){return f.toString().trim().replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(x,m,w){return m>0&&m+x.length!==w.length&&x.search(a)>-1&&w.charAt(m-2)!==":"&&(w.charAt(m+x.length)!=="-"||w.charAt(m-1)==="-")&&w.charAt(m-1).search(/[^\s-]/)<0?x.toLowerCase():x.substr(1).search(/[A-Z]|\../)>-1?x:x.charAt(0).toUpperCase()+x.substr(1)})}function l(f){return typeof f=="string"&&f.indexOf("@")!==-1}var v="REDACTED (Potential Email Address)";function c(f){return l(f)?(console.warn("This arg looks like an email address, redacting."),v):f}function g(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,w=f||"";return x&&(w=o(f)),m&&(w=c(w)),w}})(na);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GA4=void 0;var a=f(aa),o=f(na),l=["eventCategory","eventAction","eventLabel","eventValue","hitType"],v=["title","location"],c=["page","hitType"],g=["action","category","label","value","nonInteraction","transport"];function f(d){return d&&d.__esModule?d:{default:d}}function x(d,n){if(d==null)return{};var r=m(d,n),i,s;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(d);for(s=0;s<h.length;s++)i=h[s],!(n.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(d,i)&&(r[i]=d[i])}return r}function m(d,n){if(d==null)return{};var r={},i=Object.keys(d),s,h;for(h=0;h<i.length;h++)s=i[h],!(n.indexOf(s)>=0)&&(r[s]=d[s]);return r}function w(d){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?w=function(r){return typeof r}:w=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},w(d)}function b(d){return j(d)||I(d)||B(d)||y()}function y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I(d){if(typeof Symbol<"u"&&d[Symbol.iterator]!=null||d["@@iterator"]!=null)return Array.from(d)}function j(d){if(Array.isArray(d))return H(d)}function A(d,n){var r=Object.keys(d);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(d);n&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(d,s).enumerable})),r.push.apply(r,i)}return r}function M(d){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?A(Object(r),!0).forEach(function(i){_(d,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(i){Object.defineProperty(d,i,Object.getOwnPropertyDescriptor(r,i))})}return d}function D(d,n){return N(d)||J(d,n)||B(d,n)||G()}function G(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B(d,n){if(d){if(typeof d=="string")return H(d,n);var r=Object.prototype.toString.call(d).slice(8,-1);if(r==="Object"&&d.constructor&&(r=d.constructor.name),r==="Map"||r==="Set")return Array.from(d);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(d,n)}}function H(d,n){(n==null||n>d.length)&&(n=d.length);for(var r=0,i=new Array(n);r<n;r++)i[r]=d[r];return i}function J(d,n){var r=d==null?null:typeof Symbol<"u"&&d[Symbol.iterator]||d["@@iterator"];if(r!=null){var i=[],s=!0,h=!1,C,S;try{for(r=r.call(d);!(s=(C=r.next()).done)&&(i.push(C.value),!(n&&i.length===n));s=!0);}catch(E){h=!0,S=E}finally{try{!s&&r.return!=null&&r.return()}finally{if(h)throw S}}return i}}function N(d){if(Array.isArray(d))return d}function R(d,n){if(!(d instanceof n))throw new TypeError("Cannot call a class as a function")}function U(d,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(d,i.key,i)}}function W(d,n,r){return n&&U(d.prototype,n),d}function _(d,n,r){return n in d?Object.defineProperty(d,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):d[n]=r,d}var Z=function(){function d(){var n=this;R(this,d),_(this,"reset",function(){n.isInitialized=!1,n._testMode=!1,n._currentMeasurementId,n._hasLoadedGA=!1,n._isQueuing=!1,n._queueGtag=[]}),_(this,"_gtag",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];n._testMode||n._isQueuing?n._queueGtag.push(i):a.default.apply(void 0,i)}),_(this,"_loadGA",function(r,i){if(!(typeof window>"u"||typeof document>"u")&&!n._hasLoadedGA){var s=document.createElement("script");s.async=!0,s.src="https://www.googletagmanager.com/gtag/js?id=".concat(r),i&&s.setAttribute("nonce",i),document.body.appendChild(s),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},n._hasLoadedGA=!0}}),_(this,"_toGtagOptions",function(r){if(r){var i={cookieUpdate:"cookie_update",cookieExpires:"cookie_expires",cookieDomain:"cookie_domain",cookieFlags:"cookie_flags",userId:"user_id",clientId:"client_id",anonymizeIp:"anonymize_ip",contentGroup1:"content_group1",contentGroup2:"content_group2",contentGroup3:"content_group3",contentGroup4:"content_group4",contentGroup5:"content_group5",allowAdFeatures:"allow_google_signals",allowAdPersonalizationSignals:"allow_ad_personalization_signals",nonInteraction:"non_interaction",page:"page_path",hitCallback:"event_callback"},s=Object.entries(r).reduce(function(h,C){var S=D(C,2),E=S[0],T=S[1];return i[E]?h[i[E]]=T:h[E]=T,h},{});return s}}),_(this,"initialize",function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r)throw new Error("Require GA_MEASUREMENT_ID");var s=typeof r=="string"?[{trackingId:r}]:r;n._currentMeasurementId=s[0].trackingId;var h=i.gaOptions,C=i.gtagOptions,S=i.legacyDimensionMetric,E=S===void 0?!0:S,T=i.nonce,F=i.testMode,$=F===void 0?!1:F;if(n._testMode=$,$||n._loadGA(n._currentMeasurementId,T),n.isInitialized||(n._gtag("js",new Date),s.forEach(function(ie){var Te=n._appendCustomMap(M(M(M({send_page_view:!1},n._toGtagOptions(M(M({},h),ie.gaOptions))),C),ie.gtagOptions),E);n._gtag("config",ie.trackingId,Te)})),n.isInitialized=!0,!$){var q=b(n._queueGtag);for(n._queueGtag=[],n._isQueuing=!1;q.length;){var ve=q.shift();n._gtag.apply(n,b(ve)),ve[0]==="get"&&(n._isQueuing=!0)}}}),_(this,"set",function(r){if(!r){console.warn("`fieldsObject` is required in .set()");return}if(w(r)!=="object"){console.warn("Expected `fieldsObject` arg to be an Object");return}Object.keys(r).length===0&&console.warn("empty `fieldsObject` given to .set()"),n._gaCommand("set",r)}),_(this,"_gaCommandSendEvent",function(r,i,s,h,C){n._gtag("event",i,M(M({event_category:r,event_label:s,value:h},C&&{non_interaction:C.nonInteraction}),n._toGtagOptions(C)))}),_(this,"_gaCommandSendEventParameters",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];if(typeof i[0]=="string")n._gaCommandSendEvent.apply(n,b(i.slice(1)));else{var h=i[0],C=h.eventCategory,S=h.eventAction,E=h.eventLabel,T=h.eventValue;h.hitType;var F=x(h,l);n._gaCommandSendEvent(C,S,E,T,F)}}),_(this,"_gaCommandSendTiming",function(r,i,s,h){n._gtag("event","timing_complete",{name:i,value:s,event_category:r,event_label:h})}),_(this,"_gaCommandSendPageview",function(r,i){if(i&&Object.keys(i).length){var s=n._toGtagOptions(i),h=s.title,C=s.location,S=x(s,v);n._gtag("event","page_view",M(M(M(M({},r&&{page_path:r}),h&&{page_title:h}),C&&{page_location:C}),S))}else r?n._gtag("event","page_view",{page_path:r}):n._gtag("event","page_view")}),_(this,"_gaCommandSendPageviewParameters",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];if(typeof i[0]=="string")n._gaCommandSendPageview.apply(n,b(i.slice(1)));else{var h=i[0],C=h.page;h.hitType;var S=x(h,c);n._gaCommandSendPageview(C,S)}}),_(this,"_gaCommandSend",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var h=typeof i[0]=="string"?i[0]:i[0].hitType;switch(h){case"event":n._gaCommandSendEventParameters.apply(n,i);break;case"pageview":n._gaCommandSendPageviewParameters.apply(n,i);break;case"timing":n._gaCommandSendTiming.apply(n,b(i.slice(1)));break;case"screenview":case"transaction":case"item":case"social":case"exception":console.warn("Unsupported send command: ".concat(h));break;default:console.warn("Send command doesn't exist: ".concat(h))}}),_(this,"_gaCommandSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];typeof i[0]=="string"&&(i[0]=_({},i[0],i[1])),n._gtag("set",n._toGtagOptions(i[0]))}),_(this,"_gaCommand",function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),h=1;h<i;h++)s[h-1]=arguments[h];switch(r){case"send":n._gaCommandSend.apply(n,s);break;case"set":n._gaCommandSet.apply(n,s);break;default:console.warn("Command doesn't exist: ".concat(r))}}),_(this,"ga",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];if(typeof i[0]=="string")n._gaCommand.apply(n,i);else{var h=i[0];n._gtag("get",n._currentMeasurementId,"client_id",function(C){n._isQueuing=!1;var S=n._queueGtag;for(h({get:function(F){return F==="clientId"?C:F==="trackingId"?n._currentMeasurementId:F==="apiVersion"?"1":void 0}});S.length;){var E=S.shift();n._gtag.apply(n,b(E))}}),n._isQueuing=!0}return n.ga}),_(this,"event",function(r,i){if(typeof r=="string")n._gtag("event",r,n._toGtagOptions(i));else{var s=r.action,h=r.category,C=r.label,S=r.value,E=r.nonInteraction,T=r.transport,F=x(r,g);if(!h||!s){console.warn("args.category AND args.action are required in event()");return}var $={hitType:"event",eventCategory:(0,o.default)(h),eventAction:(0,o.default)(s)};C&&($.eventLabel=(0,o.default)(C)),typeof S<"u"&&(typeof S!="number"?console.warn("Expected `args.value` arg to be a Number."):$.eventValue=S),typeof E<"u"&&(typeof E!="boolean"?console.warn("`args.nonInteraction` must be a boolean."):$.nonInteraction=E),typeof T<"u"&&(typeof T!="string"?console.warn("`args.transport` must be a string."):(["beacon","xhr","image"].indexOf(T)===-1&&console.warn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),$.transport=T)),Object.keys(F).filter(function(q){return q.substr(0,9)==="dimension"}).forEach(function(q){$[q]=F[q]}),Object.keys(F).filter(function(q){return q.substr(0,6)==="metric"}).forEach(function(q){$[q]=F[q]}),n._gaCommand("send",$)}}),_(this,"send",function(r){n._gaCommand("send",r)}),_(this,"pageview",function(r,i,s){var h=r?.trim();if(h===""){console.warn("path cannot be an empty string in .pageview()");return}n._gaCommand("send","pageview",h,{title:s})}),this.reset()}return W(d,[{key:"gtag",value:function(){this._gtag.apply(this,arguments)}},{key:"_appendCustomMap",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!i)return r;r.custom_map||(r.custom_map={});for(var s=1;s<=200;s++)r.custom_map["dimension".concat(s)]||(r.custom_map["dimension".concat(s)]="dimension".concat(s)),r.custom_map["metric".concat(s)]||(r.custom_map["metric".concat(s)]="metric".concat(s));return r}},{key:"outboundLink",value:function(r,i){var s=r.label;if(typeof i!="function"){console.warn("hitCallback function is required");return}if(!s){console.warn("args.label is required in outboundLink()");return}var h={hitType:"event",eventCategory:"Outbound",eventAction:"Click",eventLabel:(0,o.default)(s)},C=!1,S=function(){C=!0,i()},E=setTimeout(S,250),T=function(){clearTimeout(E),C||i()};h.hitCallback=T,this._gaCommand("send",h)}}]),d}();t.GA4=Z;var X=new Z;t.default=X})(ta);(function(t){function a(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a=function(m){return typeof m}:a=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},a(f)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ReactGAImplementation=void 0;var o=v(ta);function l(f){if(typeof WeakMap!="function")return null;var x=new WeakMap,m=new WeakMap;return(l=function(b){return b?m:x})(f)}function v(f,x){if(f&&f.__esModule)return f;if(f===null||a(f)!=="object"&&typeof f!="function")return{default:f};var m=l(x);if(m&&m.has(f))return m.get(f);var w={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(y!=="default"&&Object.prototype.hasOwnProperty.call(f,y)){var I=b?Object.getOwnPropertyDescriptor(f,y):null;I&&(I.get||I.set)?Object.defineProperty(w,y,I):w[y]=f[y]}return w.default=f,m&&m.set(f,w),w}var c=o.GA4;t.ReactGAImplementation=c;var g=o.default;t.default=g})(ea);const Tt=Sa(ea),nr=({workingProject:t})=>{const a=u.useRef();u.useEffect(()=>{clearTimeout(a.current);const o=l=>{const{type:v}=l;v==="CLAIM"&&(console.log("Live project claimed"),jt({type:"LIVE",payload:t}))};return ka(o),a.current=setTimeout(()=>{console.log("Updated project sent to live"),jt({type:"LIVE",payload:t})},500),()=>{_a(o)}},[t])},rr=me.memo(()=>{const t=Q.getState().setMainMenuData,a=Q(c=>c.isConsoleOpen),l=Q(c=>c.consoleLogs)?.length??0,v=l>100?"100+":l;return e.jsx("div",{"data-counter":v,className:v?"customBadge":"",children:e.jsx(Ue,{title:"Show/Hide Console",children:e.jsx(P,{onFocus:c=>c.target.blur(),type:a?"primary":"default",onClick:()=>{t({isConsoleOpen:!a})},icon:e.jsx(vn,{})})})})});var sr="renderAppTopBar_topBarContainer__1ey9s4v0",or="renderAppTopBar_tabsRow__1ey9s4v1",ir="renderAppTopBar_pagesTabsArea__1ey9s4v2",lr="renderAppTopBar_pagesTabsAreaInner__1ey9s4v3",cr="renderAppTopBar_pagesTabsHolder__1ey9s4v4",dr="renderAppTopBar_envButtonArea__1ey9s4v5",Mt="renderAppTopBar_tabsAntComponent__1ey9s4v6",Pt="renderAppTopBar_tabContent__1ey9s4v7",Ft="renderAppTopBar_tabIcon__1ey9s4v8",Lt="renderAppTopBar_tabLabel__1ey9s4v9",ur="renderAppTopBar_tabSubIndicator__1ey9s4va",Et={saved:"renderAppTopBar_saveIndicator_saved__1ey9s4vc renderAppTopBar_tabUnsaved__1ey9s4vb",unsaved:"renderAppTopBar_saveIndicator_unsaved__1ey9s4vd renderAppTopBar_tabUnsaved__1ey9s4vb"},Dt="renderAppTopBar_tabClose__1ey9s4ve",mr="renderAppTopBar_envSelectorWrapper__1ey9s4vf",hr="renderAppTopBar_envLiveStartButton__1ey9s4vg",fr="renderAppTopBar_envSelectorButton__1ey9s4vh",gr="renderAppTopBar_topBarControlsRow__1ey9s4vj",pr="renderAppTopBar_viewLayoutContentBox__1ey9s4vk",at="renderAppTopBar_viewLayoutContentRow__1ey9s4vl",vr="renderAppTopBar_testDeviceRadioItem__1ey9s4vn",xr="renderAppTopBar_secondTabsRow__1ey9s4vo";const jr=({setEditProjectModalId:t,projectId:a})=>{const o=O(x=>x.workingProject?.attributes.env),l=O(x=>x.workingProject?.attributes.selectedEnv),v=u.useMemo(()=>l?o?.find(x=>x.envId===l)?.envName??"Default":"Default",[o,l]),c=({envUidToSelect:x})=>{const m=O.getState().updateProjectWithHistory;m({selectedEnv:x},!1)},g=u.useMemo(()=>o?.length?o.map(m=>({key:m.envId,label:e.jsx("div",{onClick:()=>c({envUidToSelect:m.envId}),children:m.envName}),icon:e.jsx(et,{})})):[],[o]),f=[{key:"default",label:e.jsx("div",{onClick:()=>c({envUidToSelect:""}),children:"Default"}),icon:e.jsx(et,{})},...g??[],{key:"env divider",label:e.jsx(te,{style:{margin:0}})},{key:"env settings",label:e.jsx("div",{onClick:()=>t(Number(a)),children:"Project ENV settings"}),icon:e.jsx(sn,{})}];return e.jsxs("div",{className:mr,children:[e.jsx($t,{className:"GlobalEnvSelector",dropdownRender:()=>e.jsx(Ta,{items:f,style:{whiteSpace:"nowrap"}}),trigger:["click"],children:e.jsxs("div",{className:fr,children:[e.jsxs("span",{children:[e.jsx(et,{style:{marginRight:5}}),v]}),e.jsx(Ia,{})]})}),e.jsx(Ue,{placement:"bottomRight",title:"Open Project LIVE Preview",children:e.jsx("a",{href:Ma(),target:"_blank",rel:"noreferrer",className:hr,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,viewBox:"0 0 28 28",children:e.jsx("path",{fill:"currentColor",d:"M25 9.5v5A7.5 7.5 0 0 0 14.5 25H6.25A3.25 3.25 0 0 1 3 21.75V9.5zM21.75 3A3.25 3.25 0 0 1 25 6.25V8H3V6.25A3.25 3.25 0 0 1 6.25 3zM20.5 27a6.5 6.5 0 1 0 0-13a6.5 6.5 0 0 0 0 13m-.902-9.404l4.032 2.275a.72.72 0 0 1 0 1.258l-4.032 2.274c-.49.277-1.098-.072-1.098-.629v-4.548c0-.557.609-.905 1.098-.63"})})})})]})},br=({projectName:t,isProfilePage:a})=>{const{projectId:o}=ee(),l=ct(c=>c.user?.email);let v="My Projects";return o?v=t||e.jsx(je,{}):a&&(v=e.jsxs(e.Fragment,{children:[e.jsx(Kt,{}),l]})),e.jsx(e.Fragment,{children:v})},yr=me.memo(()=>{const t=()=>{const{displayGuidePos:a,showGuides:o,lockGuides:l}=ae(f=>f.guidesOptions),v=ae.getState().updateEnvGuidesOptions,c=O(f=>f.workingProject?.attributes.guides),g=!!c?.horizontal?.length||!!c?.vertical?.length;return e.jsxs("div",{className:pr,children:[e.jsxs("div",{className:at,children:[e.jsx(de,{size:"small",checked:o,onChange:()=>{v({showGuides:!o})}}),"Show Guides"]}),e.jsxs("div",{className:at,children:[e.jsx(de,{disabled:!o,size:"small",checked:a,onChange:()=>{v({displayGuidePos:!a})}}),"Display Guides Positions"]}),e.jsxs("div",{className:at,children:[e.jsx(de,{size:"small",checked:l,onChange:()=>{v({lockGuides:!l})}}),"Lock Guides"]}),e.jsx(te,{style:{margin:"5px 0"}}),e.jsx(P,{disabled:!g,icon:e.jsx(Pa,{}),onClick:()=>{Wa()},children:"Delete all Guides"})]})};return e.jsx(ge,{placement:"bottomLeft",content:e.jsx(t,{}),trigger:"hover",children:e.jsx(P,{onFocus:a=>a.target.blur(),onClick:()=>{},icon:e.jsx("svg",{style:{translate:"-0.3em 0.1em"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 14 14",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M12.5.5h-11a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-11a1 1 0 0 0-1-1m-12 3h13m-9 0v10m9-5h-9"})}),children:"View"})})}),De="mainProjectTab",wr=()=>{const{pageId:t}=ee(),{projectId:a}=ee(),o=ut(),l=O(j=>j.tabs),v=O(j=>j.pagesHashes),c=O(j=>j.workingProject?.attributes.pages.data)??[],g=O(j=>j.currentProjectHash),f=O(j=>j.savedProjectHash),x=g===f,{removeTab:m}=O.getState();function w(j){async function A(){const{lastUseProjectTabKey:M=""}=Q.getState(),D=M?`/${M}`:"";o(`/projects/${a}${D}`)}t===j&&A().then(()=>{m(j)}),m(j)}const b=u.useCallback(j=>{const{lastUseProjectTabKey:A}=Q.getState(),D=j===De?(B=>B?`/${B}`:"")(A):"",G=j===De?`/projects/${a}`:`/projects/${a}/page/${j}`;o(G+D)},[o,a]),y=[];for(const j of l){const A=c.find(J=>String(J.id)===j.pageId);if(!A)continue;const M=v.find(J=>String(J.pageId)===String(j.pageId)),{name:D,isSubpage:G,isStatic:B}=A.attributes,H=M?M.currentHash!==M.savedHash:!1;y.push({label:e.jsxs("div",{className:Pt,children:[e.jsx("div",{className:Ft,children:e.jsx(lt,{style:{height:"auto",width:"1em"},isStatic:B})}),e.jsx("div",{className:ur,children:G?"sub":null}),e.jsx("div",{className:Et[H?"unsaved":"saved"]}),e.jsx("div",{className:Lt,children:D}),e.jsx("div",{onClick:J=>{J.stopPropagation(),w(j.pageId)},className:Dt,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m7 7l10 10M7 17L17 7"})})})]}),key:j.pageId})}const I={label:e.jsxs("div",{className:Pt,children:[e.jsx("div",{className:Ft,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 15 15",children:e.jsx("path",{fill:"currentColor",d:"M1.5 0A1.5 1.5 0 0 0 0 1.5v4A1.5 1.5 0 0 0 1.5 7h4A1.5 1.5 0 0 0 7 5.5v-4A1.5 1.5 0 0 0 5.5 0zm8 0A1.5 1.5 0 0 0 8 1.5v4A1.5 1.5 0 0 0 9.5 7h4A1.5 1.5 0 0 0 15 5.5v-4A1.5 1.5 0 0 0 13.5 0zm-8 8A1.5 1.5 0 0 0 0 9.5v4A1.5 1.5 0 0 0 1.5 15h4A1.5 1.5 0 0 0 7 13.5v-4A1.5 1.5 0 0 0 5.5 8zm8 0A1.5 1.5 0 0 0 8 9.5v4A1.5 1.5 0 0 0 9.5 15h4a1.5 1.5 0 0 0 1.5-1.5v-4A1.5 1.5 0 0 0 13.5 8z"})})}),e.jsx("div",{className:Et[x?"saved":"unsaved"]}),e.jsx("div",{className:Lt,children:"Project"}),e.jsx("div",{onClick:j=>{j.stopPropagation(),o("/projects/")},className:Dt,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m7 7l10 10M7 17L17 7"})})})]}),key:De};return e.jsxs("div",{className:lr,children:[e.jsx(Ie,{className:Mt,activeKey:t??De,onChange:b,items:[I]}),e.jsx("div",{className:cr,children:e.jsx(Ie,{className:Mt,popupClassName:"pagesTabsPopup",activeKey:t??De,onChange:b,items:y})})]})};var Cr="secondRowTabs_secondRowTabContainer__1jvc5q0",se="secondRowTabs_tabLabel__1jvc5q1";const Sr=[{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M12 17h.009M20 8.5v5c0 3.771 0 5.657-1.172 6.828S15.771 21.5 12 21.5s-5.657 0-6.828-1.172S4 17.271 4 13.5v-5"}),e.jsx("path",{d:"m22 10.5l-4.343-4.165C14.99 3.778 13.657 2.5 12 2.5S9.01 3.778 6.343 6.335L2 10.5"})]})}),"Dashboard"]}),key:"projectDashboard"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M3.5 10c0-3.771 0-5.657 1.245-6.828S7.993 2 12 2h.773c3.26 0 4.892 0 6.024.798c.324.228.612.5.855.805c.848 1.066.848 2.6.848 5.67v2.545c0 2.963 0 4.445-.469 5.628c-.754 1.903-2.348 3.403-4.37 4.113c-1.257.441-2.83.441-5.98.441c-1.798 0-2.698 0-3.416-.252c-1.155-.406-2.066-1.263-2.497-2.35c-.268-.676-.268-1.523-.268-3.216z"}),e.jsx("path",{d:"M20.5 12a3.333 3.333 0 0 1-3.333 3.333c-.666 0-1.451-.116-2.098.057a1.67 1.67 0 0 0-1.179 1.179c-.173.647-.057 1.432-.057 2.098A3.333 3.333 0 0 1 10.5 22M8 7h7m-7 4h3"})]})}),"Pages"]}),key:"projectPages"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M20 12.5V7.818c0-1.693 0-2.54-.268-3.216c-.43-1.087-1.342-1.944-2.497-2.35C16.517 2 15.617 2 13.818 2c-3.148 0-4.722 0-5.98.441c-2.02.71-3.615 2.21-4.37 4.113C3 7.737 3 9.219 3 12.182v2.545c0 3.07 0 4.604.848 5.67q.366.461.855.805C5.81 21.982 7.39 22 10.5 22"}),e.jsx("path",{d:"M3 12a3.333 3.333 0 0 1 3.333-3.333c.666 0 1.451.116 2.098-.057A1.67 1.67 0 0 0 9.61 7.43c.173-.647.057-1.432.057-2.098A3.333 3.333 0 0 1 13 2m1.813 20c-.57-.59-2.813-2.16-2.813-3s2.244-2.41 2.813-3m3.374 6c.57-.59 2.813-2.16 2.813-3s-2.244-2.41-2.812-3"})]})}),"SubPages"]}),key:"projectSubPages"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2 12c0-3.69 0-5.534.814-6.841a4.8 4.8 0 0 1 1.105-1.243C5.08 3 6.72 3 10 3h4c3.28 0 4.919 0 6.081.916c.43.338.804.759 1.105 1.243C22 6.466 22 8.31 22 12s0 5.534-.814 6.841a4.8 4.8 0 0 1-1.105 1.243C18.92 21 17.28 21 14 21h-4c-3.28 0-4.919 0-6.081-.916a4.8 4.8 0 0 1-1.105-1.243C2 17.534 2 15.69 2 12m7.5-9v18M5 7h1m-1 3h1",color:"currentColor"})}),"Global Containers"]}),key:"projectGlobalContainers"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M16 9c-3.184 0-4.816 6.02-8 6.02"}),e.jsx("path",{d:"M15.54 15.02c-.809 0-1.253 0-1.594-.12a1.8 1.8 0 0 1-.52-.284c-.265-.21-.41-.509-.7-1.108l-1.451-2.995c-.29-.6-.436-.9-.7-1.108a1.8 1.8 0 0 0-.52-.284C9.712 9 9.268 9 8.46 9"})]})}),"Variables"]}),key:"projectVariables"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("ellipse",{cx:12,cy:5,rx:8,ry:3}),e.jsx("path",{d:"M20 12c0 1.657-3.582 3-8 3s-8-1.343-8-3"}),e.jsx("path",{d:"M20 5v14c0 1.657-3.582 3-8 3s-8-1.343-8-3V5m4 3v2m0 5v2"})]})}),"Data Sources"]}),key:"projectDataSources"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M8 15.889C8.15 16.42 8.455 17 9.25 17c1.375 0 1.719-1.111 2.75-5s1.375-5 2.75-5c.795 0 1.1.58 1.25 1.111m-5.667 2.5h4.417"}),e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"})]})}),"Functions"]}),key:"projectFunctions"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("circle",{cx:7.5,cy:7.5,r:1.5}),e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M5 21c4.372-5.225 9.274-12.116 16.498-7.458"})]})}),"Media"]}),key:"projectMedia"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M7 9.5c-.24-1.995.916-2.403 5-2.5m0 0c4.123.1 5.341.598 5 2.5M12 7v10m-2 0h4"}),e.jsx("path",{d:"M3.891 3.891C2.5 5.282 2.5 7.521 2.5 12c0 4.478 0 6.718 1.391 8.109S7.521 21.5 12 21.5c4.478 0 6.718 0 8.109-1.391S21.5 16.479 21.5 12c0-4.478 0-6.718-1.391-8.109S16.479 2.5 12 2.5c-4.478 0-6.718 0-8.109 1.391"})]})}),"Fonts"]}),key:"projectFonts"}],kr=({isSubpage:t})=>[{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 3c0-.471 0-.707-.146-.854C15.707 2 15.47 2 15 2h-1c-.471 0-.707 0-.854.146C13 2.293 13 2.53 13 3v1c0 .471 0 .707.146.854C13.293 5 13.53 5 14 5h1c.471 0 .707 0 .854-.146C16 4.707 16 4.47 16 4zM8.333 8.407C9.938 6.68 22.01 10.913 22 12.46c-.011 1.752-4.714 2.292-6.018 2.658c-.784.22-.994.445-1.175 1.267c-.818 3.723-1.23 5.574-2.166 5.616c-1.493.066-5.874-11.906-4.308-13.593M5 3c0-.471 0-.707-.146-.854C4.707 2 4.47 2 4 2H3c-.471 0-.707 0-.854.146C2 2.293 2 2.53 2 3v1c0 .471 0 .707.146.854C2.293 5 2.53 5 3 5h1c.471 0 .707 0 .854-.146C5 4.707 5 4.47 5 4zm0 11c0-.471 0-.707-.146-.854C4.707 13 4.47 13 4 13H3c-.471 0-.707 0-.854.146C2 13.293 2 13.53 2 14v1c0 .471 0 .707.146.854C2.293 16 2.53 16 3 16h1c.471 0 .707 0 .854-.146C5 15.707 5 15.47 5 15zm-1.5-1V5M13 3.5H5",color:"currentColor"})}),"Editor"]}),key:"pageEditor"},{label:e.jsxs("span",{className:se,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,color:"currentColor",children:[e.jsx("path",{d:"M2.5 12c0-4.478 0-6.718 1.391-8.109S7.521 2.5 12 2.5c4.478 0 6.718 0 8.109 1.391S21.5 7.521 21.5 12c0 4.478 0 6.718-1.391 8.109S16.479 21.5 12 21.5c-4.478 0-6.718 0-8.109-1.391S2.5 16.479 2.5 12"}),e.jsx("path",{d:"M16 9c-3.184 0-4.816 6.02-8 6.02"}),e.jsx("path",{d:"M15.54 15.02c-.809 0-1.253 0-1.594-.12a1.8 1.8 0 0 1-.52-.284c-.265-.21-.41-.509-.7-1.108l-1.451-2.995c-.29-.6-.436-.9-.7-1.108a1.8 1.8 0 0 0-.52-.284C9.712 9 9.268 9 8.46 9"})]})}),"Parameters"]}),key:"parameters"}],_r=me.memo(()=>{const t=Q(m=>m.lastUseProjectTabKey??"projectDashboard"),{projectInfoSection:a=t,pageInfoSection:o="pageEditor",projectId:l,pageId:v}=ee(),c=ut(),g=m=>{const w=Q.getState().setMainMenuData;v?c(`/projects/${l}/page/${v}/${m}`):(c(`/projects/${l}/${m}`),w({lastUseProjectTabKey:m}))};u.useEffect(()=>{const m=Q.getState().setMainMenuData;return()=>{m({lastUseProjectTabKey:void 0})}},[]);const f=Q(m=>m.isSubpageEditor),x=u.useMemo(()=>kr({isSubpage:f}),[f]);return e.jsx(Ie,{tabBarGutter:0,className:Cr,size:"small",items:v?x:Sr,activeKey:v?o:a,onChange:g})});var At="testDeviceButton_dimensionsPopTitle__88rnak0",Nt="testDeviceButton_dimensionsPopTitleSmall__88rnak1",Ir="testDeviceButton_dimensionsDeviceListScroll__88rnak2",Tr="testDeviceButton_addUserDeviceForm__88rnak3";const Rt=({deviceItem:t,editable:a=!1})=>{const{name:o,width:l,height:v,uid:c}=t,g=f=>{f.stopPropagation(),f.preventDefault();const x=$e.getState().removeUserTestDevice;x(c)};return e.jsx(fe,{value:c,children:e.jsxs("div",{className:vr,children:[o,e.jsxs(dt,{style:{fontSize:11,padding:2,lineHeight:"1em"},children:[l," x ",v]}),a&&e.jsx(Fa,{style:{color:"red"},className:"close",onClick:g})]})})},Mr=()=>{const t=ae.getInitialState().updateEnvStore,a=ae(b=>b.selectedTestDevice),{userDefinedTestDevices:o,predefinedTestDevices:l}=$e(b=>b),v=b=>{let y=b.target.value;y=y==="none"?null:y;const I=[...o,...l].find(j=>j.uid===y);if(I){const{fitEditor:j}=ae.getState();t({selectedTestDevice:I}),j()}else throw new Error("Test device not found")},c=u.useMemo(()=>o.map(b=>e.jsx(Rt,{editable:!0,deviceItem:b},b.uid)),[o]),g=u.useMemo(()=>l.map(b=>e.jsx(Rt,{editable:!1,deviceItem:b},b.uid)),[l]),[f]=p.useForm(),[x,m]=me.useState(!1),w=b=>{m(!0);const y=$e.getState().createUserTestDevice;y(b).then(()=>{f.resetFields(),m(!1)})};return e.jsxs(e.Fragment,{children:[e.jsx(fe.Group,{onChange:v,value:a?.uid,children:e.jsx(Ne,{style:{width:400},direction:"vertical",children:e.jsxs("div",{className:Ir,children:[e.jsxs(yt,{initialOpen:!0,summary:"My devices",children:[...c]}),e.jsxs(yt,{initialOpen:!0,summary:"Predefined devices",children:[...g]})]})})}),e.jsx(te,{style:{margin:"10px 0"}}),e.jsx(p,{form:f,onFinish:w,onFinishFailed:()=>m(!1),className:Tr,layout:"vertical",children:e.jsxs(Ne,{children:[e.jsx(p.Item,{required:!1,name:"name",rules:[{required:!0,message:"Required"}],label:"Name",children:e.jsx(z,{style:{width:100},placeholder:"Name"})}),e.jsx(p.Item,{required:!1,name:"width",rules:[{required:!0,message:"Required"}],label:"Width",children:e.jsx(it,{min:0,style:{width:100},placeholder:"Width"})}),e.jsx(p.Item,{required:!1,name:"height",rules:[{required:!0,message:"Required"}],label:"Height",children:e.jsx(it,{min:0,style:{width:100},placeholder:"Height"})}),e.jsx(p.Item,{label:" ",children:e.jsx(P,{loading:x,htmlType:"submit",block:!0,icon:e.jsx(La,{}),children:"Add device"})})]})})]})},Pr=()=>{const t=Q(c=>c.isSubpageEditor),a=ae(c=>c.selectedTestDevice),o=ae(c=>c.isTestDeviceRotated),l=()=>{const c=ae.getState().updateEnvStore;c({isTestDeviceRotated:!o})},v=t?e.jsxs("div",{className:At,children:["Subpage editor - no test devices available here",e.jsxs("small",{className:Nt,children:[e.jsx(We,{})," Subpage is a reusable component - it has own size and there is no sense to test it on different devices in fullscreen mode."]})]}):e.jsxs("div",{className:At,children:["Test device selector",e.jsxs("small",{className:Nt,children:[e.jsx(We,{})," It's not a project setting, just preview option to see how page looks on different devices."]})]});return e.jsxs(Ne.Compact,{block:!0,children:[e.jsx(ge,{placement:"bottomLeft",title:v,content:t?null:e.jsx(Mr,{}),trigger:t?"hover":"click",children:e.jsx(P,{disabled:t,onFocus:c=>c.target.blur(),icon:e.jsx("svg",{style:{translate:"-0.3em 0.1em"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32",children:e.jsx("path",{fill:"currentColor",d:"M13 3H7.5A4.5 4.5 0 0 0 3 7.5V9a1 1 0 0 0 2 0V7.5A2.5 2.5 0 0 1 7.5 5H13a1 1 0 1 0 0-2m2.5 26a4.5 4.5 0 0 0 4.5-4.5v-8a4.5 4.5 0 0 0-4.5-4.5h-8A4.5 4.5 0 0 0 3 16.5v8A4.5 4.5 0 0 0 7.5 29zm6.5-1a1 1 0 0 1 1-1h1.5a2.5 2.5 0 0 0 2.5-2.5V19a1 1 0 1 1 2 0v5.5a4.5 4.5 0 0 1-4.5 4.5H23a1 1 0 0 1-1-1m7-15V7.5A4.5 4.5 0 0 0 24.5 3H19a1 1 0 1 0 0 2h5.5A2.5 2.5 0 0 1 27 7.5V13a1 1 0 1 0 2 0"})}),children:a?.name})}),e.jsx(P,{disabled:t,onFocus:c=>c.target.blur(),onClick:l,type:o?"primary":"default",icon:e.jsx("svg",{style:{translate:"0 2px"},xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",fillRule:"evenodd",d:"M16.26 1.874a.75.75 0 0 1 .866-.613c3.2.544 5.624 3.36 5.624 6.74a.75.75 0 0 1-1.17.62l-1.5-1.014a.75.75 0 1 1 .84-1.242l.1.067c-.577-1.91-2.18-3.358-4.146-3.693a.75.75 0 0 1-.613-.865M8.319 3.316c-.579.442-1.257 1.118-2.232 2.092l-.678.679c-.974.974-1.65 1.652-2.092 2.232c-.429.561-.566.941-.566 1.307s.137.746.566 1.308c.442.579 1.118 1.257 2.092 2.232l5.427 5.426c.974.974 1.652 1.65 2.231 2.092c.563.43.942.566 1.308.566s.746-.137 1.308-.566c.579-.442 1.257-1.118 2.232-2.092l.678-.678c.974-.975 1.65-1.653 2.092-2.232c.429-.562.566-.942.566-1.308s-.137-.745-.566-1.307c-.442-.58-1.118-1.258-2.092-2.232l-5.427-5.427c-.974-.974-1.652-1.65-2.231-2.092c-.562-.429-.942-.566-1.308-.566s-.746.137-1.308.566m-.91-1.193c.696-.53 1.392-.873 2.218-.873s1.522.343 2.217.873c.67.51 1.418 1.26 2.345 2.186l5.503 5.504c.927.926 1.676 1.675 2.186 2.344c.53.695.873 1.391.873 2.217s-.343 1.522-.873 2.218c-.51.668-1.26 1.417-2.186 2.344l-.755.755c-.927.927-1.676 1.676-2.344 2.186c-.696.53-1.392.873-2.218.873s-1.522-.343-2.217-.873c-.67-.51-1.418-1.26-2.344-2.186L4.31 14.188c-.927-.927-1.676-1.676-2.186-2.344c-.53-.696-.873-1.392-.873-2.218s.343-1.522.873-2.217c.51-.67 1.26-1.418 2.186-2.344l.755-.756c.927-.926 1.676-1.675 2.345-2.186m2.07 2.903a.75.75 0 0 1 0 1.06L6.086 9.479a.75.75 0 1 1-1.06-1.06l3.391-3.392a.75.75 0 0 1 1.06 0m6.74 10.218a.689.689 0 1 0-.974.974a.689.689 0 0 0 .974-.974m-2.035-1.06a2.189 2.189 0 1 1 3.096 3.095a2.189 2.189 0 0 1-3.096-3.096M1.648 15.337a.75.75 0 0 1 .772.04l1.5 1.015a.75.75 0 0 1-.84 1.242l-.1-.067c.577 1.91 2.18 3.358 4.146 3.693a.75.75 0 0 1-.252 1.479c-3.2-.545-5.624-3.361-5.624-6.74a.75.75 0 0 1 .398-.662",clipRule:"evenodd"})})})]})},Fr=()=>{Ea();const{xPanelStatus:t="disconnected",lastErrorMessage:a}=bt(),o=bt.getState().updateXpanelStore;function l(){o({manualStartConnect:!0})}function v(){return t==="disconnected"?a?e.jsx(pe,{style:{color:"red"}}):e.jsx(bn,{}):e.jsx(mn,{})}const c=e.jsx(P,{icon:v(),loading:t==="connecting",onClick:()=>l(),children:t.charAt(0).toUpperCase()+t.slice(1)});return a?e.jsx(ge,{placement:"bottomLeft",title:"Last connect message",content:a,trigger:"hover",children:c}):c},Lr=me.memo(({subPageHeight:t,subPageWidth:a})=>{const o=ae(m=>m.editorZoom),l=Number.parseFloat((o*100).toFixed(0)),v=({value:m})=>{const w=Number(m)||1,{updateEditorZoom:b}=ae.getState();b(w/100)},{resetEditorZoom:c,centerViewer:g,fitEditor:f}=ae.getState(),x=()=>{a&&t?f(a,t):f()};return e.jsxs(Ne,{style:{minWidth:250},direction:"vertical",size:"small",children:[e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("div",{style:{flexGrow:1},children:e.jsx($a,{min:1,max:100,value:l,onChange:m=>{v({value:m})}})}),e.jsx(z,{addonAfter:"%",style:{width:87},value:l,onChange:m=>{v({value:m.target.value})}})]}),e.jsxs(Ne.Compact,{block:!0,children:[e.jsx(P,{style:{flexGrow:1},onClick:x,children:"Fit"}),e.jsx(P,{style:{flexGrow:1},onClick:g,children:"Center"}),e.jsx(P,{style:{flexGrow:1},onClick:c,children:"Reset"})]})]})}),Er=()=>{const{pageId:t}=ee(),a=(ae(g=>g.editorZoom)*100).toFixed(0),o=ht({pageId:t}),l=Q(g=>g.isSubpageEditor),{width:v,height:c}=Da({width:o?.attributes.width,height:o?.attributes.height});return e.jsx(e.Fragment,{children:e.jsx(ge,{placement:"bottomLeft",title:"Zoom controls",content:e.jsx(Lr,{subPageHeight:l?c:void 0,subPageWidth:l?v:void 0}),trigger:"click",children:e.jsxs(P,{onFocus:g=>g.target.blur(),icon:e.jsxs("svg",{style:{translate:"-0.3em 0.1em",scale:"1.2"},width:"1em",height:"1em",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("g",{clipPath:"url(#clip0_224_4)",children:[e.jsx("path",{d:"M9.7 9.7L11 11M10.35 7.425C10.35 7.04088 10.2743 6.66053 10.1273 6.30565C9.98035 5.95077 9.7649 5.62832 9.49329 5.35671C9.22168 5.0851 8.89923 4.86965 8.54435 4.72265C8.18947 4.57566 7.80912 4.5 7.425 4.5C7.04088 4.5 6.66053 4.57566 6.30565 4.72265C5.95077 4.86965 5.62832 5.0851 5.35671 5.35671C5.0851 5.62832 4.86965 5.95077 4.72265 6.30565C4.57566 6.66053 4.5 7.04088 4.5 7.425C4.5 8.20076 4.80817 8.94474 5.35671 9.49329C5.90526 10.0418 6.64924 10.35 7.425 10.35C8.20076 10.35 8.94474 10.0418 9.49329 9.49329C10.0418 8.94474 10.35 8.20076 10.35 7.425Z",stroke:"black",strokeWidth:"0.75",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9.5375 9.5375L11 11M1 3C1.065 2.3325 1.213 1.883 1.548 1.548C1.883 1.213 2.3325 1.0655 3 1M3 11C2.3325 10.935 1.883 10.787 1.548 10.452C1.213 10.117 1.0655 9.6675 1 9M11 3C10.935 2.3325 10.787 1.883 10.452 1.548C10.117 1.213 9.6675 1.0655 9 1M1 5V7M7 1H5M10.35 7.425C10.35 6.64924 10.0418 5.90526 9.49329 5.35671C8.94474 4.80817 8.20076 4.5 7.425 4.5C6.64924 4.5 5.90526 4.80817 5.35671 5.35671C4.80817 5.90526 4.5 6.64924 4.5 7.425C4.5 8.20076 4.80817 8.94474 5.35671 9.49329C5.90526 10.0418 6.64924 10.35 7.425 10.35C8.20076 10.35 8.94474 10.0418 9.49329 9.49329C10.0418 8.94474 10.35 8.20076 10.35 7.425Z",stroke:"black",strokeWidth:"0.75",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_224_4",children:e.jsx("rect",{width:"12",height:"12",fill:"white"})})})]}),children:[a,"%"]})})})},Dr=me.lazy(()=>mt(()=>import("./undoRedo-GMSbyzn2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url)),Ar=me.lazy(()=>mt(()=>import("./newProjectModal-DWeQAiK7.js"),__vite__mapDeps([14,1,2,9,3,4,5,6,7,8,10,11,12,13]),import.meta.url)),Nr=({setEditProjectModalId:t})=>{const a=ut(),{projectId:o}=ee(),{pageId:l}=ee(),c=Jt().pathname.includes("profile"),g=O(b=>b.workingProject),f=Q(b=>b.showBoundingBox),{setMainMenuData:x}=Q.getState(),[m,w]=u.useState(!1);return e.jsxs("div",{className:sr,onContextMenu:b=>b.preventDefault(),children:[!!o&&!!g&&e.jsxs(e.Fragment,{children:[e.jsx("section",{children:e.jsxs("div",{className:or,children:[e.jsx("div",{className:ir,children:e.jsx(wr,{})}),e.jsx("div",{className:dr,children:e.jsx(jr,{projectId:o,setEditProjectModalId:t})})]})}),e.jsx("section",{className:xr,children:e.jsx(_r,{})})]}),e.jsx("section",{children:e.jsxs("div",{className:gr,style:f?{}:{backgroundColor:"rgb(66, 32, 201)",color:"#fff"},children:[e.jsxs("section",{className:"left",style:{fontSize:14},children:[e.jsx("img",{onClick:()=>a("/projects"),style:{width:"auto",height:23,cursor:"pointer"},src:Aa,alt:"avgator studio"}),e.jsx(br,{isProfilePage:c,projectName:g?.attributes.name})]}),e.jsx("section",{className:"center",children:l?e.jsxs(e.Fragment,{children:[e.jsx(yr,{}),e.jsx(Pr,{}),e.jsx(Er,{}),e.jsxs(fe.Group,{style:{whiteSpace:"nowrap"},value:f,onChange:b=>x({showBoundingBox:b.target.value}),buttonStyle:"solid",children:[e.jsxs(fe.Button,{value:!0,children:[e.jsx(Na,{})," Editor"]}),e.jsxs(fe.Button,{style:f?{}:{backgroundColor:"red",color:"#fff",borderColor:"red"},className:"previewButton",value:!1,children:[e.jsx(Gt,{})," Preview"]})]}),e.jsx(Fr,{}),e.jsx(rr,{})]}):null}),e.jsxs("section",{className:"right",style:{display:"flex",gap:5},children:[!o&&!c?e.jsx(P,{icon:e.jsx(Wt,{}),onClick:()=>w(!0),type:"primary",children:"New Project"}):null,!o&&!c&&e.jsx($t,{menu:{items:[{key:"Profile",label:e.jsx("div",{onClick:()=>a("/profile"),children:"Profile"})},{key:"Logout",label:e.jsx("div",{onClick:()=>ot(),children:"Change Account"})}]},placement:"bottomRight",arrow:!0,children:e.jsx(P,{icon:e.jsx(Kt,{})})}),c&&e.jsxs(e.Fragment,{children:[e.jsx(P,{icon:e.jsx(cn,{}),onClick:()=>a("/projects"),children:"Back to projects"}),e.jsx(P,{onClick:()=>ot(),icon:e.jsx(Cn,{}),children:"Logout"})]}),o&&e.jsx(u.Suspense,{fallback:null,children:e.jsx(Dr,{})})]}),e.jsx("div",{style:{position:"absolute"},children:m?e.jsx(u.Suspense,{fallback:e.jsx(Zt,{}),children:e.jsx(Ar,{setOpenNewProjectModal:w})}):null})]})})]})},Rr=u.lazy(()=>mt(()=>import("./main-C9kTvUvK.js").then(t=>t.eR),__vite__mapDeps([1,2]),import.meta.url)),Vr=()=>{const t=ct(L=>L.jwt),a=Jt(),[o,l]=Ra();Va();const v=Oa();u.useEffect(()=>{if(o.size){let L=function(){l({})};const ne=o.get("paymentFeedback");if(ne)switch(ne){case"buyBuildError":oe.error({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"red",paddingBottom:5},children:e.jsx(pe,{})}),"We cannot process your payment. Please try again later."]}),okText:"Close",onOk:()=>L()});break;case"buyBuildOk":oe.success({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"green",paddingBottom:5},children:e.jsx(Ba,{})}),"Thank you for your purchase! Now project have unlimited builds."]}),okText:"Close",onOk:()=>L()});break;default:oe.error({icon:null,maskClosable:!1,content:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{color:"red",paddingBottom:5},children:e.jsx(pe,{})}),"Unknown payment feedback: ",ne]}),okText:"Close",onOk:()=>L()}),console.error("Unknown payment feedback: ",ne);break}}return()=>{oe.destroyAll()}},[o,l]),Vt.interceptors.response.use(L=>L.data&&(L?.status===200||L?.status===201)?L:Promise.reject(L),L=>(L.response?.status===401&&ot(),Promise.reject(L)));const c=window.location.hostname;u.useEffect(()=>{c==="avstudio.app"&&Tt.initialize("G-CJ806X6F1C")},[c]),u.useEffect(()=>{a.pathname&&c==="avstudio.app"&&Tt.send({hitType:"pageview",page:a.pathname})},[c,a.pathname]),u.useEffect(()=>{t||v("/login")},[a.pathname,t,v]);const{projectId:g}=ee(),{pageId:f}=ee(),{ConfirmModal:x}=On(),{fillProjectsList:m}=za.getState(),{fetchAndFill:w,resetWorkingProject:b,clearHistory:y}=O.getState(),I=O(L=>L.workingProject),j=u.useRef(!1);u.useEffect(()=>{function L(){Qe.destroy(),j.current=!1}async function ne(he){await fetch(he,{headers:{Pragma:"no-cache",Expires:"-1","Cache-Control":"no-cache"}}),window.location.href=he,window.location.reload()}if(!g&&t&&!j.current){const he=Za.getState().fetchVersions;try{he().then(we=>{if(we?.length){const Me="3.1.1",Ke=we?.[0],{version:le,text:Je}=Ke?.attributes??{};if(!Me||!le)return;let Oe=!1;const Ze=Number(Me.replace(/\./g,"")),k=Number(le.replace(/\./g,""));Ze<k&&(Oe=!0),Oe&&(j.current=!0,Qe.destroy(),Qe.info({message:"New version available",onClose:L,description:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:5},children:e.jsxs(dt,{children:["Current ",Me," => New ",le]})}),Je," ",e.jsx(te,{style:{margin:"15px 0"}})," ",e.jsx(P,{onClick:()=>{ne(window.location.href)},style:{marginRight:5},type:"primary",children:"Refresh to update"}),e.jsx(P,{onClick:()=>L(),children:"Later"})]}),onClick:()=>{},placement:"top",duration:null}))}})}catch(we){console.log(we)}}},[g,t]),qa({initVariableArr:I?.attributes.variables}),Ga({skipDsLoading:!1});const A=ht({pageId:f}),M=Q(L=>L.showBoundingBox),{setMainMenuData:D}=Q.getState(),{addNewTab:G,clearTabs:B}=O.getState(),H=ae.getState().setEnvState,J=Q(L=>L.selectedMenuSection.elementIndex);u.useEffect(()=>{if(J===null){const L=ze.getState().setSelectedElementRef;L({current:null})}},[J]),u.useEffect(()=>{A?.attributes.isSubpage?D({isSubpageEditor:!0}):D({isSubpageEditor:!1})},[A?.attributes.isSubpage,D]),u.useEffect(()=>{A?.attributes.isStatic?(D({isStaticEditor:!0}),ce.info({content:"You are in adaptive editor mode",style:{position:"fixed",bottom:"50px",left:"50%",translate:"-50% 0"}})):D({isStaticEditor:!1})},[A?.attributes.isStatic,D]),nr({workingProject:I}),u.useEffect(()=>{f&&H(M?"editor":"preview")},[f,H,M]),u.useEffect(()=>{f&&I&&G(f)},[G,f,I]),u.useLayoutEffect(()=>{if(!t)return;const L=Qt.getState().fetchAndFillThemesList;L();const ne=$e.getState().fetchTestDevices;ne()},[t]),u.useEffect(()=>{y()},[y,f]),u.useEffect(()=>{g||Ha()},[g]);const N=u.useRef(!1);u.useLayoutEffect(()=>{t&&(g?(I&&String(I.id)!==g&&b(),!I&&!N.current&&(N.current=!0,w(g).then(()=>{N.current=!1}))):(m(),B(),y()))},[w,m,g,b,I?.id,B,y,I,t]);const[R,U]=u.useState(null),[W,_]=u.useState(null),[Z,X]=u.useState(null),[d,n]=u.useState(!1),[r,i]=u.useState(!1),[s,h]=u.useState(null),[C,S]=u.useState(!1),{CloneModal:E,setCloneItemModal:T}=Rn(),F={editProjectModalId:R,setEditProjectModalId:U,newPageModalVisible:W,setNewPageModalVisible:_,newGlobalContainerVisible:C,setNewGlobalContainerVisible:S,setNewDatasourceVisible:n,newDatasourceVisible:d,setNewModificatorVisible:i,newModificatorVisible:r,setEditModificator:h,editModificator:s,newVariableModalVisible:Z,setNewVariableModalVisible:X,CloneModal:E,setCloneItemModal:T},$=ze(L=>L.selectedElementRef),q=Q(L=>L.isStaticEditor),ve=ze(L=>L.staticEementsGuidesClasses),ie=ze(L=>L.activeStaticElementKey),Te=u.useMemo(()=>ve.filter(L=>L!==ie),[ie,ve]);return e.jsxs(e.Fragment,{children:[e.jsxs(Xa,{children:[e.jsx(Ya,{children:e.jsx(Nr,{setEditProjectModalId:U})}),e.jsx(Qa,{children:e.jsx(Ua,{context:F})})]}),R&&e.jsx(zn,{editProjectModalId:R,setEditProjectModalId:U},g+"_EditProjectModal"),W&&e.jsx(tr,{newPageModalVisible:W,setNewPageModalVisible:_},g+"_NewPageModal"),Z&&e.jsx(ar,{setNewVariableModalVisible:X,newVariableModalVisible:Z},g+"_NewVariableModal"),C&&e.jsx($n,{setNewGlobalContainerVisible:S,newGlobalContainerVisible:C},g+"_NewGlobalContainerModal"),r&&e.jsx(er,{setNewModificatorVisible:i,newModificatorVisible:r},g+"_NewModificatorModal"),d&&e.jsx(Wn,{setNewDatasourceVisible:n,newDatasourceVisible:d},g+"_NewDatasourceModal"),E,e.jsx(x,{}),q&&e.jsx(u.Suspense,{fallback:e.jsx(Zt,{}),children:e.jsx(Rr,{target:M?$:null,zoom:1,snappable:!0,snapThreshold:5,snapContainer:".page",bounds:{left:0,top:0,right:0,bottom:0,position:"css"},isDisplaySnapDigit:!0,isDisplayInnerSnapDigit:!1,snapGap:!0,snapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},dragTargetSelf:!1,elementGuidelines:Te,useMutationObserver:!0,origin:!1,throttleResize:0,throttleDrag:0,throttleRotate:0,startDragRotate:0,throttleDragRotate:0,draggable:!0,resizable:!1,scalable:!1,keepRatio:!0,rotatable:!1,padding:10,onDrag:L=>{const{target:ne,transform:he}=L;ne.style.transform=he}})})]})},Zr=Object.freeze(Object.defineProperty({__proto__:null,default:Vr},Symbol.toStringTag,{value:"Module"}));export{ke as R,Zr as m,Qt as u};
